<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель аналитики и статистики - TOCO</title>
    <meta name="description" content="Комплексная панель аналитики рынка труда Республики Таджикистан. Профессиональные инструменты для анализа занятости, безработицы, вакансий и трудовой миграции.">
    
    <style>
        .gauge-container {
            position: relative;
            margin: 0 auto;
            width: 100%;
            height: 240px;
            display: flex;
            justify-content: center;
            margin-top: 1rem;
        }
        .stat-card {
            overflow: hidden;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 350px;
            position: relative;
        }
        .gauge-label {
            position: absolute;
            top: -10px;
            left: 0;
            right: 0;
            text-align: center;
            width: 100%;
            font-size: 18px;
            font-weight: 700;
            color: #333;
            background: white;
            padding: 5px 0;
            border-radius: 15px 15px 0 0;
            margin: 0 auto;
            max-width: 160px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 10;
        }
    </style>
    
    <!-- Стили и библиотеки -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js и плагины -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
    
    <!-- Конфигурация и утилиты аналитики -->
    <script src="js/analytics-config.js"></script>
    
    <!-- Демонстрационные данные -->
    <script src="js/sample-data.js"></script>
    
    <!-- Дополнительные компоненты аналитики -->
    <script src="js/analytics_components.js"></script>
    
    <!-- Дополнительные стили -->
    <link rel="stylesheet" href="css/analytics-enhanced.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Анимация для кнопки меню */
        @keyframes menuPulse {
            0%, 100% {
                transform: translateY(-50%) scale(1);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.4);
            }
            50% {
                transform: translateY(-50%) scale(1.05);
                box-shadow: 0 0 0 10px rgba(79, 70, 229, 0);
            }
        }

        /* Кнопка меню */
        .menu-toggle {
            position: fixed;
            top: 50%;
            left: -2px;
            transform: translateY(-50%);
            writing-mode: vertical-rl;
            text-orientation: mixed;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 20px 8px;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 1px;
            border-radius: 0 12px 12px 0;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 2px 2px 15px rgba(0,0,0,0.2);
            animation: menuPulse 3s infinite;
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            transform: translateY(-50%) translateX(5px);
        }

        /* Боковое меню */
        .side-menu {
            position: fixed;
            left: -350px;
            top: 0;
            width: 350px;
            height: 100vh;
            background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
            color: #e2e8f0;
            z-index: 1100;
            overflow-y: auto;
            transition: left 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 5px 0 20px rgba(0,0,0,0.3);
        }

        .side-menu.open {
            left: 0;
        }

        .side-menu .menu-header {
            padding: 2rem;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .side-menu .menu-item {
            padding: 12px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .side-menu .menu-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: #4f46e5;
            transform: translateX(5px);
        }

        .side-menu .menu-item.active {
            background: rgba(79, 70, 229, 0.2);
            color: white;
            border-left-color: #4f46e5;
        }

        .side-menu .menu-item i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        /* Затемнение фона */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1050;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(2px);
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Выдвижная панель фильтров */
        .filter-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
            transition: right 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1200;
            overflow-y: auto;
        }

        .filter-sidebar.open {
            right: 0;
        }

        .filter-header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 2rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        /* Градиентный фон */
        .gradient-bg {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #ec4899 100%);
        }

        /* Стили для карточек */
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }
        
        /* Стили для улучшенных карточек статистики */
        .stat-card-enhanced {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 180px;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .stat-card-enhanced:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        /* Стили для мини-графиков в карточках */
        .chart-mini {
            height: 80px;
            width: 100%;
            margin: 0.5rem 0;
            position: relative;
            background-color: rgba(240, 245, 255, 0.5);
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* Стили для биржевых диаграмм */
        .stock-chart {
            position: relative;
            height: 100%;
            width: 100%;
        }
        
        .chart-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-rows: repeat(4, 1fr);
        }
        
        .chart-grid-line {
            width: 100%;
            height: 1px;
            background-color: rgba(203, 213, 225, 0.5);
        }
        
        .chart-candle {
            position: absolute;
            bottom: 0;
            width: 6px;
            background-color: #10b981;
            transition: height 0.5s ease, background-color 0.3s ease;
        }
        
        .chart-candle.down {
            background-color: #ef4444;
        }
        
        .chart-line {
            position: absolute;
            bottom: 0;
            height: 2px;
            background-color: #3b82f6;
            z-index: 2;
        }
        
        .chart-point {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: #3b82f6;
            transform: translate(-50%, -50%);
            z-index: 3;
        }
        
        .value-change {
            position: absolute;
            right: 10px;
            top: 10px;
            font-size: 12px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .value-change.up {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .value-change.down {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        /* Стили для кнопки LIVE */
        .live-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 3px 10px;
            font-size: 11px;
            font-weight: 600;
            color: #3b82f6;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .live-indicator:hover {
            background-color: #3b82f6;
            color: white;
            transform: scale(1.05);
        }
        
        .live-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #10b981;
            position: relative;
            display: inline-block;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
            }
            
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }
        
        /* Стили для эффекта подсветки при обновлении */
        @keyframes highlight {
            0% { color: #3b82f6; }
            50% { color: #10b981; }
            100% { color: inherit; }
        }
        
        .highlight-update {
            animation: highlight 1s ease-out;
        }
        
        /* Делаем карточки более интерактивными */
        .stat-card-enhanced {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .stat-card-enhanced:hover {
            transform: translateY(-7px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }
        
        /* Стиль активной кнопки LIVE */
        .live-indicator.active .live-dot {
            animation: pulse 1.5s infinite;
        }

        /* Инструментальные карточки */
        .tool-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
            overflow: hidden;
            position: relative;
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #4f46e5, #7c3aed, #ec4899);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .tool-card:hover::before {
            transform: scaleX(1);
        }

        .tool-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
            border-color: #4f46e5;
        }

        .tool-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--icon-color-1), var(--icon-color-2));
            color: white;
            font-size: 1.5rem;
        }

        /* Контейнеры для диаграмм */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 1rem 0;
        }

        .chart-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }

        /* Современные круговые диаграммы (спидометр) */
        .speedometer-container {
            position: relative;
            width: 300px;
            height: 200px;
            margin: 0 auto;
        }

        .speedometer-bg {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            height: 140px;
            border: 15px solid #f3f4f6;
            border-bottom: 15px solid transparent;
            border-radius: 280px 280px 0 0;
        }

        .speedometer-fill {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            height: 140px;
            border: 15px solid transparent;
            border-bottom: 15px solid transparent;
            border-radius: 280px 280px 0 0;
            transition: all 1s ease-in-out;
        }

        .speedometer-needle {
            position: absolute;
            top: 125px;
            left: 50%;
            transform-origin: 50% 0%;
            width: 4px;
            height: 120px;
            background: #1f2937;
            border-radius: 2px;
            transition: transform 1s ease-in-out;
        }

        .speedometer-center {
            position: absolute;
            top: 115px;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: #374151;
            border-radius: 50%;
        }

        .speedometer-value {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }

        /* Интерактивные элементы */
        .interactive-element {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .interactive-element:hover {
            transform: scale(1.02);
        }

        /* Кнопки фильтров */
        .filter-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.4);
        }

        /* Анимации загрузки */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
            z-index: 10;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .side-menu {
                width: 100%;
                left: -100%;
            }
            
            .filter-sidebar {
                width: 100%;
                right: -100%;
            }
        }

        /* Темы для инструментов */
        .theme-analytics { --icon-color-1: #3b82f6; --icon-color-2: #1d4ed8; }
        .theme-statistics { --icon-color-1: #10b981; --icon-color-2: #059669; }
        .theme-forecasting { --icon-color-1: #f59e0b; --icon-color-2: #d97706; }
        .theme-migration { --icon-color-1: #ef4444; --icon-color-2: #dc2626; }
        .theme-skills { --icon-color-1: #8b5cf6; --icon-color-2: #7c3aed; }
        .theme-salaries { --icon-color-1: #06b6d4; --icon-color-2: #0891b2; }

        /* Стили для вкладок */
        .tab-container {
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 2rem;
        }

        .tab-button {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #6b7280;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: #4f46e5;
            border-bottom-color: #4f46e5;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Современные стили для виджетов с эффектом glassmorphism */
        .glassmorphism {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            padding: 1.5rem;
        }
        
        .glassmorphism::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4f46e5, #ec4899);
            opacity: 0.8;
            transition: transform 0.4s ease;
            transform: scaleX(0);
            transform-origin: left;
        }
        
        .glassmorphism:hover::before {
            transform: scaleX(1);
        }
        
        .glassmorphism:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(31, 38, 135, 0.2);
        }
        
        /* Индикатор точки цвета */
        .indicator-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        /* Переключатели периода */
        .period-selector {
            padding: 5px 12px;
            font-size: 12px;
            font-weight: 600;
            background-color: rgba(243, 244, 246, 0.7);
            color: #6b7280;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .period-selector:hover {
            background-color: rgba(209, 213, 219, 0.7);
        }
        
        .period-selector.active {
            background-color: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        /* Анимированный контейнер 3D графика */
        .employment-3d-container {
            position: relative;
            height: 350px;
            perspective: 1000px;
        }
        
        .employment-3d-container canvas {
            transform: rotateX(5deg);
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }
        
        .employment-3d-container:hover canvas {
            transform: rotateX(10deg) scale(1.02);
        }
        
        .chart-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 10;
        }
        
        /* Стили для контейнера отраслевого распределения */
        .industry-ring-container {
            position: relative;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1000px;
        }
        
        /* Центральная статистика в кольце */
        .center-stat {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
        }
        
        .center-value {
            font-size: 32px;
            font-weight: 700;
            color: #111827;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .center-label {
            font-size: 14px;
            color: #6b7280;
            margin-top: 4px;
        }
        
        .center-change-indicator {
            font-size: 14px;
            font-weight: 600;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .center-change-indicator.up {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .center-change-indicator.down {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .center-change-indicator.stable {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6b7280;
        }
        
        /* Легенда отраслей */
        .industry-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            padding: 0 15px;
        }
        
        .industry-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            flex: 1;
            min-width: 120px;
        }
        
        .industry-item:hover {
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        
        .color-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .industry-item .name {
            flex-grow: 1;
            font-size: 12px;
            font-weight: 500;
            color: #4b5563;
        }
        
        .industry-item .value {
            font-weight: 700;
            font-size: 14px;
            color: #111827;
            margin-right: 8px;
        }
        
        .trend {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .trend.up {
            color: #10b981;
        }
        
        .trend.down {
            color: #ef4444;
        }
        
        .trend.stable {
            color: #6b7280;
        }
        
        /* Плавающие иконки */
        .floating-stats {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .floating-stat-item {
            position: absolute;
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-stat-item:nth-child(2) {
            animation-delay: -2s;
        }
        
        .floating-stat-item:nth-child(3) {
            animation-delay: -4s;
        }
        
        .floating-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            color: #3b82f6;
        }
        
        /* Панель деталей отрасли */
        .industry-details {
            margin-top: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
            max-height: 200px;
            overflow: hidden;
        }
        
        .industry-details.collapse {
            max-height: 0;
            padding: 0 15px;
            opacity: 0;
            margin: 0;
        }
        
        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .close-details {
            cursor: pointer;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(243, 244, 246, 0.7);
            transition: all 0.2s ease;
        }
        
        .close-details:hover {
            background-color: rgba(209, 213, 219, 0.7);
        }
        
        .details-content {
            font-size: 14px;
            color: #4b5563;
        }
        
        /* Стили для региональной карты */
        .regional-heatmap-container {
            position: relative;
            height: 320px;
        }
        
        .chart-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            padding: 0 15px;
        }
        
        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            background-color: rgba(243, 244, 246, 0.7);
            color: #6b7280;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover {
            background-color: rgba(209, 213, 219, 0.7);
        }
        
        .filter-btn.active {
            background-color: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .region-map-wrapper {
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .region-map {
            width: 100%;
            height: 100%;
            position: relative;
            background-color: rgba(243, 244, 246, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }
        
        /* Пульсирующие точки на карте */
        .map-pulsing-dots {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: all;
        }
        
        .pulsing-dot {
            position: absolute;
            cursor: pointer;
            z-index: 10;
        }
        
        .pulse-ring {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: rgba(59, 130, 246, 0.3);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
        }
        
        .pulse-core {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #3b82f6;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
        }
        
        .pulse-label {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            background-color: rgba(255, 255, 255, 0.9);
            color: #111827;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            opacity: 0;
            transition: all 0.2s ease;
            pointer-events: none;
        }
        
        .pulsing-dot:hover .pulse-label,
        .pulsing-dot.active .pulse-label {
            opacity: 1;
            transform: translateX(-50%) translateY(-5px);
        }
        
        .pulsing-dot.active .pulse-ring {
            background-color: rgba(16, 185, 129, 0.3);
            animation: pulse 1.5s infinite;
        }
        
        .pulsing-dot.active .pulse-core {
            background-color: #10b981;
            width: 12px;
            height: 12px;
        }
        
        /* Панель региональной детализации */
        .region-highlight {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 20;
            transition: all 0.3s ease;
            max-width: 200px;
        }
        
        .region-name {
            font-size: 16px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 5px;
        }
        
        .region-value {
            font-size: 24px;
            font-weight: 700;
            color: #111827;
        }
        
        .region-label {
            font-size: 12px;
            color: #6b7280;
            margin: 2px 0 5px;
        }
        
        .region-growth {
            display: inline-flex;
            align-items: center;
            font-size: 13px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
        }
        
        .region-growth.positive {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .region-growth.negative {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        /* Детальная панель региона */
        .region-detail-panel {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 20;
            width: 250px;
            transition: all 0.3s ease;
        }
        
        .region-detail-header {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        
        .region-stats {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 3px;
        }
        
        .region-stat-label {
            font-size: 12px;
            color: #6b7280;
        }
        
        .region-stat-value {
            display: flex;
            align-items: center;
        }
        
        .fa-star, .fa-star-half-alt {
            color: #f59e0b;
            font-size: 12px;
            margin-right: 2px;
        }
        
        .region-detail-stats {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .region-stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background-color: rgba(243, 244, 246, 0.7);
            border-radius: 8px;
        }
        
        .stat-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-radius: 8px;
        }
        
        .stat-info {
            flex-grow: 1;
        }
        
        .stat-value {
            font-size: 16px;
            font-weight: 700;
            color: #111827;
        }
        
        .stat-label {
            font-size: 11px;
            color: #6b7280;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        .stat-trend.up {
            color: #10b981;
        }
        
        .stat-trend.down {
            color: #ef4444;
        }
        
        /* Анимация пульсации */
        @keyframes pulse {
            0% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.8;
            }
            70% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
            100% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0;
            }
        }
        
        /* Анимация плавания */
        @keyframes float {
            0% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
            100% {
                transform: translateY(0px);
            }
        }
        
        /* Контроллеры для графиков */
        .chart-controls {
            display: flex;
            gap: 5px;
        }
        
        .chart-control-btn {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(243, 244, 246, 0.7);
            color: #6b7280;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .chart-control-btn:hover {
            background-color: rgba(209, 213, 219, 0.7);
        }
        
        .chart-control-btn.active {
            background-color: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .chart-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        .chart-highlight {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(59, 130, 246, 0.3);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .chart-data-tooltip {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            font-size: 12px;
            transform: translateY(10px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .chart-data-tooltip .date {
            font-weight: 500;
            color: #6b7280;
        }
        
        .chart-data-tooltip .value {
            font-size: 16px;
            font-weight: 700;
            color: #111827;
            margin: 5px 0;
        }
        
        .chart-data-tooltip .value span {
            color: #3b82f6;
        }
        
        .chart-data-tooltip .change {
            font-size: 11px;
            font-weight: 600;
        }
        
        .chart-data-tooltip .change.up {
            color: #10b981;
        }
        
        .chart-data-tooltip .change.down {
            color: #ef4444;
        }
        
        /* Секция с инсайтами */
        .chart-insights {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .insight-badge {
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            border-radius: 8px;
            display: flex;
            align-items: center;
        }
        
        .insight-badge.positive {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .insight-badge.negative {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .insight-badge.neutral {
            background-color: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        /* Интерактивное кольцо отраслей */
        .industry-ring-container {
            position: relative;
            height: 300px;
        }
        
        .center-stat {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 5;
        }
        
        .center-value {
            font-size: 28px;
            font-weight: 700;
            color: #111827;
            line-height: 1;
        }
        
        .center-label {
            font-size: 14px;
            color: #6b7280;
            margin-top: 5px;
        }
        
        .industry-legend {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .industry-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            padding: 6px;
            border-radius: 6px;
            transition: background-color 0.3s ease;
        }
        
        .industry-item:hover {
            background-color: rgba(243, 244, 246, 0.5);
        }
        
        .color-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .industry-item .name {
            flex: 1;
            color: #4b5563;
        }
        
        .industry-item .value {
            font-weight: 600;
            color: #111827;
        }
        
        .industry-item .trend {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 10px;
        }
        
        .industry-item .trend.up {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .industry-item .trend.down {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .industry-item .trend.stable {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6b7280;
        }
        
        /* Контроллеры графиков */
        .chart-controls, .stat-actions, .sort-controls {
            display: flex;
            gap: 8px;
        }
        
        .chart-control-btn, .stat-action-btn, .sort-btn {
            background: rgba(243, 244, 246, 0.7);
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .chart-control-btn:hover, .stat-action-btn:hover, .sort-btn:hover {
            background: rgba(209, 213, 219, 0.7);
        }
        
        .stat-action-btn.active, .sort-btn.active {
            background-color: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        /* Региональная тепловая карта */
        .regional-heatmap-container {
            height: 350px;
            position: relative;
            display: flex;
        }
        
        .region-map-wrapper {
            position: relative;
            flex: 1;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .region-map {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .region-highlight {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            max-width: 200px;
            z-index: 10;
        }
        
        .region-name {
            font-weight: 700;
            font-size: 16px;
            color: #111827;
        }
        
        .region-value {
            font-size: 24px;
            font-weight: 700;
            color: #3b82f6;
            margin: 8px 0 2px;
        }
        
        .region-label {
            font-size: 12px;
            color: #6b7280;
        }
        
        .region-growth {
            margin-top: 8px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .region-growth.positive {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .region-growth.negative {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .regional-legend {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        .legend-gradient {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
            color: #6b7280;
        }
        
        .gradient-bar {
            height: 6px;
            width: 150px;
            border-radius: 3px;
            background: linear-gradient(90deg, #cffafe, #06b6d4, #0369a1);
        }
        
        /* Анимированные бары вакансий */
        .vacancies-race-container {
            height: 350px;
            position: relative;
        }
        
        .vacancy-bars-wrapper {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px 0;
            height: 100%;
            overflow-y: auto;
        }
        
        .vacancy-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }
        
        .vacancy-item:hover {
            background-color: rgba(243, 244, 246, 0.7);
        }
        
        .vacancy-rank {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            color: #4b5563;
        }
        
        .vacancy-name {
            flex: 1;
            font-size: 13px;
            font-weight: 500;
            color: #374151;
        }
        
        .vacancy-bar {
            flex: 2;
            height: 10px;
            background-color: #f3f4f6;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #818cf8);
            border-radius: 5px;
            position: absolute;
            left: 0;
            top: 0;
            transition: width 1s cubic-bezier(0.65, 0, 0.35, 1);
        }
        
        .vacancy-count {
            width: 60px;
            font-size: 14px;
            font-weight: 600;
            text-align: right;
            color: #111827;
        }
        
        .vacancy-growth {
            width: 60px;
            font-size: 12px;
            font-weight: 600;
            text-align: right;
        }
        
        .vacancy-growth.positive {
            color: #10b981;
        }
        
        .vacancy-growth.negative {
            color: #ef4444;
        }
        
        .chart-footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 10px;
        }
        
        /* Анимации для виджетов */
        @keyframes float {
            0% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-5px);
            }
            100% {
                transform: translateY(0px);
            }
        }
        
        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        .shimmer-effect {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0) 0%, 
                rgba(255,255,255,0.8) 50%, 
                rgba(255,255,255,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Кнопка меню -->
    <div class="menu-toggle" id="menuToggle">
        Меню
    </div>

    <!-- Боковое меню -->
    <div class="side-menu" id="sideMenu">
        <div class="menu-header">
            <h2 class="text-xl font-bold">TOCO Analytics</h2>
            <p class="text-sm opacity-90 mt-1">Панель аналитики</p>
        </div>
        
        <nav>
            <a href="index.html" class="menu-item">
                <i class="fas fa-home"></i>
                <span>Главная</span>
            </a>
            <a href="#dashboard" class="menu-item active">
                <i class="fas fa-chart-pie"></i>
                <span>Дашборд</span>
            </a>
            <a href="#analytics" class="menu-item">
                <i class="fas fa-chart-line"></i>
                <span>Аналитика</span>
            </a>
            <a href="#statistics" class="menu-item">
                <i class="fas fa-chart-bar"></i>
                <span>Статистика</span>
            </a>
            <a href="#reports" class="menu-item">
                <i class="fas fa-file-alt"></i>
                <span>Отчеты</span>
            </a>
            <a href="#forecasting" class="menu-item">
                <i class="fas fa-crystal-ball"></i>
                <span>Прогнозирование</span>
            </a>
            <a href="serchwork.html" class="menu-item">
                <i class="fas fa-search"></i>
                <span>Поиск работы</span>
            </a>
            <a href="news.html" class="menu-item">
                <i class="fas fa-newspaper"></i>
                <span>Новости</span>
            </a>
            <a href="user_profile.html" class="menu-item">
                <i class="fas fa-user"></i>
                <span>Профиль</span>
            </a>
        </nav>
    </div>

    <!-- Затемнение фона -->
    <div class="overlay" id="overlay"></div>

    <!-- Выдвижная панель фильтров -->
    <div class="filter-sidebar" id="filterSidebar">
        <div class="filter-header">
            <div class="flex justify-between items-center">
                <h3 class="text-xl font-bold">Фильтры и настройки</h3>
                <button id="closeFilters" class="text-white hover:text-gray-200">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>
        
        <div class="p-6 space-y-6">
            <!-- Региональные фильтры -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Регион</label>
                <select id="regionFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="all">Все регионы</option>
                    <option value="dushanbe">Душанбе</option>
                    <option value="rrp">РРП</option>
                    <option value="sughd">Согд</option>
                    <option value="khatlon">Хатлон</option>
                    <option value="gbao">ГБАО</option>
                </select>
            </div>

            <!-- Временной период -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Период</label>
                <select id="periodFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="week">Последняя неделя</option>
                    <option value="month" selected>Последний месяц</option>
                    <option value="quarter">Последний квартал</option>
                    <option value="year">Последний год</option>
                    <option value="custom">Пользовательский период</option>
                </select>
            </div>

            <!-- Отрасли -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Отрасль</label>
                <select id="industryFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="all">Все отрасли</option>
                    <option value="it">ИТ и телекоммуникации</option>
                    <option value="manufacturing">Производство</option>
                    <option value="agriculture">Сельское хозяйство</option>
                    <option value="services">Услуги</option>
                    <option value="construction">Строительство</option>
                    <option value="education">Образование</option>
                    <option value="healthcare">Здравоохранение</option>
                    <option value="finance">Финансы</option>
                </select>
            </div>

            <!-- Тип занятости -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Тип занятости</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" value="full-time" class="mr-2 text-blue-600">
                        <span class="text-sm">Полная занятость</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" value="part-time" class="mr-2 text-blue-600">
                        <span class="text-sm">Частичная занятость</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" value="freelance" class="mr-2 text-blue-600">
                        <span class="text-sm">Фриланс</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" value="contract" class="mr-2 text-blue-600">
                        <span class="text-sm">Контракт</span>
                    </label>
                </div>
            </div>

            <!-- Уровень образования -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Уровень образования</label>
                <select id="educationFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="all">Все уровни</option>
                    <option value="basic">Базовое</option>
                    <option value="secondary">Среднее</option>
                    <option value="vocational">Профессиональное</option>
                    <option value="higher">Высшее</option>
                    <option value="postgraduate">Послевузовское</option>
                </select>
            </div>

            <!-- Кнопки действий -->
            <div class="flex space-x-3 pt-4">
                <button id="applyFilters" class="flex-1 filter-btn">
                    <i class="fas fa-filter mr-2"></i>
                    Применить
                </button>
                <button id="resetFilters" class="flex-1 bg-gray-200 text-gray-700 px-4 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                    <i class="fas fa-undo mr-2"></i>
                    Сбросить
                </button>
            </div>
        </div>
    </div>

    <!-- Основной контент -->
    <main class="transition-all duration-300">
        <!-- Шапка -->
        <header class="gradient-bg text-white shadow-xl">
            <div class="container mx-auto px-6 py-8">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-4xl font-bold mb-2">Панель аналитики и статистики</h1>
                        <p class="text-xl opacity-90">Комплексный анализ рынка труда Республики Таджикистан</p>
                    </div>
                    <div class="flex space-x-4">
                        <button id="openFilters" class="bg-white bg-opacity-20 px-6 py-3 rounded-lg font-semibold hover:bg-opacity-30 transition-all">
                            <i class="fas fa-sliders-h mr-2"></i>
                            Фильтры
                        </button>
                        <button id="exportData" class="bg-white bg-opacity-20 px-6 py-3 rounded-lg font-semibold hover:bg-opacity-30 transition-all">
                            <i class="fas fa-download mr-2"></i>
                            Экспорт
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Ключевые метрики -->
        <section class="container mx-auto px-6 py-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Общая занятость -->
                <div class="stat-card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-blue-100 rounded-lg">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500">vs прошлый месяц</div>
                            <div class="text-green-500 font-semibold">+2.4%</div>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-gray-800" id="totalEmployment">1,847,230</div>
                    <div class="text-gray-600">Общая занятость</div>
                    <div class="mt-4 flex justify-center">
                        <div class="gauge-container">
                            <span class="gauge-label">Занятость</span>
                            <canvas id="employmentGauge" width="240" height="240"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Уровень безработицы -->
                <div class="stat-card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-red-100 rounded-lg">
                            <i class="fas fa-chart-line-down text-red-600 text-xl"></i>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500">vs прошлый месяц</div>
                            <div class="text-red-500 font-semibold">+0.3%</div>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-gray-800" id="unemploymentRate">7.2%</div>
                    <div class="text-gray-600">Уровень безработицы</div>
                    <div class="mt-4 flex justify-center">
                        <div class="gauge-container">
                            <span class="gauge-label">Безработица</span>
                            <canvas id="unemploymentGauge" width="240" height="240"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Активные вакансии -->
                <div class="stat-card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-green-100 rounded-lg">
                            <i class="fas fa-briefcase text-green-600 text-xl"></i>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500">vs прошлый месяц</div>
                            <div class="text-green-500 font-semibold">+12.8%</div>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-gray-800" id="activeVacancies">23,456</div>
                    <div class="text-gray-600">Активные вакансии</div>
                    <div class="mt-4 flex justify-center">
                        <div class="gauge-container">
                            <span class="gauge-label">Вакансии</span>
                            <canvas id="vacanciesGauge" width="240" height="240"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Средняя зарплата -->
                <div class="stat-card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-yellow-100 rounded-lg">
                            <i class="fas fa-money-bill-wave text-yellow-600 text-xl"></i>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500">vs прошлый месяц</div>
                            <div class="text-green-500 font-semibold">+5.2%</div>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-gray-800" id="averageSalary">2,847</div>
                    <div class="text-gray-600">Средняя зарплата (сомони)</div>
                    <div class="mt-4 flex justify-center">
                        <div class="gauge-container">
                            <span class="gauge-label">Зарплаты</span>
                            <canvas id="salaryGauge" width="240" height="240"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Дополнительные статистические карточки -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Тренд занятости -->
                <div class="stat-card-enhanced" data-stat="employment-rate">
                    <div class="live-indicator">
                        <span class="live-dot"></span>
                        LIVE
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Тренд занятости</h4>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                    </div>
                    <div class="stat-value text-2xl font-bold text-gray-800 mb-2">95.0%</div>
                    <div class="chart-mini mb-3">
                        <canvas id="employment-trend-mini" width="120" height="50"></canvas>
                    </div>
                    <div class="text-xs text-gray-500">За последние 12 месяцев</div>
                </div>

                <!-- Активность на рынке -->
                <div class="stat-card-enhanced" data-stat="total-population">
                    <div class="live-indicator">
                        <span class="live-dot"></span>
                        LIVE
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Трудовые ресурсы</h4>
                        <div class="trend-indicator trend-stable">
                            <i class="fas fa-minus"></i>
                        </div>
                    </div>
                    <div class="stat-value text-2xl font-bold text-gray-800 mb-2">2.4М</div>
                    <div class="chart-mini mb-3">
                        <canvas id="vacancies-trend-mini" width="120" height="50"></canvas>
                    </div>
                    <div class="text-xs text-gray-500">Трудоспособное население</div>
                </div>

                <!-- Региональное распределение -->
                <div class="stat-card-enhanced" data-stat="labor-force">
                    <div class="live-indicator">
                        <span class="live-dot"></span>
                        LIVE
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">По регионам</h4>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                    </div>
                    <div class="stat-value text-2xl font-bold text-gray-800 mb-2">5</div>
                    <div class="chart-mini mb-3">
                        <canvas id="regional-mini" width="120" height="50"></canvas>
                    </div>
                    <div class="text-xs text-gray-500">Основных регионов</div>
                </div>

                <!-- Отраслевое распределение -->
                <div class="stat-card-enhanced" data-stat="job-seekers">
                    <div class="live-indicator">
                        <span class="live-dot"></span>
                        LIVE
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">По отраслям</h4>
                        <div class="trend-indicator trend-down">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                    </div>
                    <div class="stat-value text-2xl font-bold text-gray-800 mb-2">10</div>
                    <div class="chart-mini mb-3">
                        <canvas id="industries-mini" width="120" height="50"></canvas>
                    </div>
                    <div class="text-xs text-gray-500">Основных отраслей</div>
                </div>
            </div>
        </section>

        <!-- Вкладки аналитики -->
        <section class="container mx-auto px-6">
            <div class="tab-container">
                <button class="tab-button active" data-tab="overview">Обзор</button>
                <button class="tab-button" data-tab="analytics">Аналитика</button>
                <button class="tab-button" data-tab="forecasting">Прогнозирование</button>
                <button class="tab-button" data-tab="migration">Миграция</button>
                <button class="tab-button" data-tab="skills">Навыки</button>
            </div>

            <!-- Вкладка "Обзор" -->
            <div class="tab-content active" id="overview">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Динамика занятости - современная 3D карта с градиентами -->
                    <div class="stat-card glassmorphism">
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            LIVE
                        </div>
                        <div class="chart-header flex justify-between items-center">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                                    <span class="indicator-dot bg-blue-500 mr-2"></span>
                                    Динамика занятости
                                </h3>
                                <p class="text-sm text-gray-500 mt-1">Реальные данные с рынка труда</p>
                            </div>
                            <div class="flex space-x-2">
                                <button class="period-selector active" data-period="6m">6М</button>
                                <button class="period-selector" data-period="1y">1Г</button>
                                <button class="period-selector" data-period="all">Все</button>
                            </div>
                        </div>
                        <div class="chart-container employment-3d-container">
                            <canvas id="employmentTrendChart"></canvas>
                            <div class="chart-overlay">
                                <div class="chart-highlight"></div>
                                <div class="chart-data-tooltip">
                                    <div class="date">Июнь 2025</div>
                                    <div class="value"><span>95.2%</span> занятости</div>
                                    <div class="change up">+2.1% с прошлого месяца</div>
                                </div>
                            </div>
                        </div>
                        <div class="chart-insights">
                            <div class="insight-badge positive">
                                <i class="fas fa-arrow-trend-up mr-1"></i> Рост 2.1%
                            </div>
                            <div class="insight-badge neutral">
                                <i class="fas fa-calendar-check mr-1"></i> Сезонность
                            </div>
                        </div>
                    </div>

                    <!-- Распределение по отраслям - интерактивное кольцо с 3D эффектами -->
                    <div class="stat-card glassmorphism">
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            LIVE
                        </div>
                        <div class="chart-header flex justify-between items-center">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                                    <span class="indicator-dot bg-purple-500 mr-2"></span>
                                    Распределение по отраслям
                                </h3>
                                <p class="text-sm text-gray-500 mt-1">Структура рынка по секторам</p>
                            </div>
                            <div class="chart-controls">
                                <button class="chart-control-btn active" data-action="viewType" data-view="donut">
                                    <i class="fas fa-chart-pie"></i>
                                </button>
                                <button class="chart-control-btn" data-action="viewType" data-view="polar">
                                    <i class="fas fa-chart-line"></i>
                                </button>
                                <button class="chart-control-btn" data-action="download">
                                    <i class="fas fa-download"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-container industry-ring-container">
                            <div class="chart-overlay">
                                <div class="chart-highlight-radial"></div>
                            </div>
                            <canvas id="industryDistributionChart"></canvas>
                            <div class="center-stat">
                                <div class="center-value animated-number">45.8%</div>
                                <div class="center-label">Сфера услуг</div>
                                <div class="center-change-indicator up">
                                    <i class="fas fa-arrow-up"></i> 3.2%
                                </div>
                            </div>
                            <div class="floating-stats">
                                <div class="floating-stat-item" style="top: 30%; left: 22%;">
                                    <div class="floating-icon">
                                        <i class="fas fa-briefcase"></i>
                                    </div>
                                </div>
                                <div class="floating-stat-item" style="top: 60%; left: 75%;">
                                    <div class="floating-icon">
                                        <i class="fas fa-tractor"></i>
                                    </div>
                                </div>
                                <div class="floating-stat-item" style="top: 20%; left: 65%;">
                                    <div class="floating-icon">
                                        <i class="fas fa-industry"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="industry-legend">
                            <div class="industry-item" data-industry="services">
                                <span class="color-dot bg-blue-500"></span>
                                <span class="name">Услуги</span>
                                <span class="value animated-value">45.8%</span>
                                <span class="trend up"><i class="fas fa-arrow-up"></i></span>
                            </div>
                            <div class="industry-item" data-industry="agriculture">
                                <span class="color-dot bg-green-500"></span>
                                <span class="name">Сельское хозяйство</span>
                                <span class="value animated-value">21.3%</span>
                                <span class="trend down"><i class="fas fa-arrow-down"></i></span>
                            </div>
                            <div class="industry-item" data-industry="production">
                                <span class="color-dot bg-yellow-500"></span>
                                <span class="name">Производство</span>
                                <span class="value animated-value">18.5%</span>
                                <span class="trend stable"><i class="fas fa-minus"></i></span>
                            </div>
                        </div>
                        <div class="industry-details collapse">
                            <div class="details-header">
                                <h4 class="text-md font-semibold">Детали по отрасли: <span class="industry-detail-name">Услуги</span></h4>
                                <div class="close-details">
                                    <i class="fas fa-times"></i>
                                </div>
                            </div>
                            <div class="details-content">
                                <div class="flex justify-between mb-2">
                                    <span>Занятость в отрасли:</span>
                                    <span class="font-semibold">846,230 чел.</span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span>Средняя зарплата:</span>
                                    <span class="font-semibold">3,250 сомони</span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span>Рост за последний год:</span>
                                    <span class="font-semibold text-green-500">+3.2%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Региональная статистика - интерактивная тепловая карта -->
                    <div class="stat-card glassmorphism">
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            LIVE
                        </div>
                        <div class="chart-header flex justify-between items-center">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                                    <span class="indicator-dot bg-green-500 mr-2"></span>
                                    Региональная статистика
                                </h3>
                                <p class="text-sm text-gray-500 mt-1">Анализ по регионам</p>
                            </div>
                            <div class="chart-controls">
                                <button class="chart-control-btn active" data-action="viewType" data-view="map">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="chart-control-btn" data-action="viewType" data-view="bars">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                                <button class="chart-control-btn" data-action="download">
                                    <i class="fas fa-download"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-container regional-heatmap-container">
                            <div class="chart-filters">
                                <div class="filter-btn active" data-filter="vacancies">Вакансии</div>
                                <div class="filter-btn" data-filter="unemployment">Безработица</div>
                                <div class="filter-btn" data-filter="salary">Зарплата</div>
                            </div>
                            <div class="region-map-wrapper">
                                <div class="region-map">
                                    <!-- SVG карта Таджикистана с интерактивными регионами будет добавлена через JS -->
                                    <div class="map-pulsing-dots">
                                        <div class="pulsing-dot" style="top: 35%; left: 60%;" data-region="dushanbe" data-value="9845">
                                            <div class="pulse-ring"></div>
                                            <div class="pulse-core"></div>
                                            <div class="pulse-label">Душанбе</div>
                                        </div>
                                        <div class="pulsing-dot" style="top: 20%; left: 30%;" data-region="sughd" data-value="6254">
                                            <div class="pulse-ring"></div>
                                            <div class="pulse-core"></div>
                                            <div class="pulse-label">Согд</div>
                                        </div>
                                        <div class="pulsing-dot" style="top: 65%; left: 45%;" data-region="khatlon" data-value="4875">
                                            <div class="pulse-ring"></div>
                                            <div class="pulse-core"></div>
                                            <div class="pulse-label">Хатлон</div>
                                        </div>
                                        <div class="pulsing-dot" style="top: 40%; left: 80%;" data-region="gbao" data-value="2325">
                                            <div class="pulse-ring"></div>
                                            <div class="pulse-core"></div>
                                            <div class="pulse-label">ГБАО</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="region-highlight" id="selectedRegion">
                                    <div class="region-name">Душанбе</div>
                                    <div class="region-value animated-number">9,845</div>
                                    <div class="region-label">активных вакансий</div>
                                    <div class="region-growth positive">
                                        <i class="fas fa-arrow-up"></i>
                                        <span class="trend-value">12.4%</span> рост
                                    </div>
                                </div>
                            </div>
                            <div class="region-detail-panel">
                                <div class="region-detail-header">
                                    <h4 class="region-name">Душанбе</h4>
                                    <div class="region-stats">
                                        <span class="region-stat-label">Рейтинг активности:</span>
                                        <span class="region-stat-value">
                                            <i class="fas fa-star filled"></i>
                                            <i class="fas fa-star filled"></i>
                                            <i class="fas fa-star filled"></i>
                                            <i class="fas fa-star filled"></i>
                                            <i class="fas fa-star-half-alt"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="region-detail-stats">
                                    <div class="region-stat-item">
                                        <div class="stat-icon">
                                            <i class="fas fa-briefcase"></i>
                                        </div>
                                        <div class="stat-info">
                                            <div class="stat-value animated-value">9,845</div>
                                            <div class="stat-label">Активных вакансий</div>
                                        </div>
                                        <div class="stat-trend up">
                                            <i class="fas fa-arrow-up"></i> 
                                            <span class="trend-value">12.4%</span>
                                        </div>
                                    </div>
                                    <div class="region-stat-item">
                                        <div class="stat-icon">
                                            <i class="fas fa-users"></i>
                                        </div>
                                        <div class="stat-info">
                                            <div class="stat-value animated-value">2.8%</div>
                                            <div class="stat-label">Уровень безработицы</div>
                                        </div>
                                        <div class="stat-trend down">
                                            <i class="fas fa-arrow-down"></i> 
                                            <span class="trend-value">1.2%</span>
                                        </div>
                                    </div>
                                    <div class="region-stat-item">
                                        <div class="stat-icon">
                                            <i class="fas fa-money-bill-wave"></i>
                                        </div>
                                        <div class="stat-info">
                                            <div class="stat-value animated-value">4,250</div>
                                            <div class="stat-label">Средняя зарплата (сомони)</div>
                                        </div>
                                        <div class="stat-trend up">
                                            <i class="fas fa-arrow-up"></i> 
                                            <span class="trend-value">5.4%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <canvas id="regionalStatsChart"></canvas>
                        </div>
                        <div class="regional-legend">
                            <div class="legend-gradient">
                                <span>Низкий</span>
                                <div class="gradient-bar"></div>
                                <span>Высокий</span>
                            </div>
                        </div>
                    </div>

                    <!-- Топ вакансий - современная анимированная гистограмма с микроанимациями -->
                    <div class="stat-card glassmorphism">
                        <div class="live-indicator" style="left: 10px; right: auto;">
                            <span class="live-dot"></span>
                            LIVE
                        </div>
                        <div class="chart-header flex justify-between items-center">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                                    <span class="indicator-dot bg-yellow-500 mr-2"></span>
                                    Топ-10 вакансий
                                </h3>
                                <p class="text-sm text-gray-500 mt-1">Самые востребованные специальности</p>
                            </div>
                            <div class="sort-controls">
                                <button class="sort-btn active" data-sort="count">
                                    <i class="fas fa-sort-amount-down"></i> По количеству
                                </button>
                                <button class="sort-btn" data-sort="growth">
                                    <i class="fas fa-chart-line"></i> По росту
                                </button>
                            </div>
                        </div>
                        <div class="chart-container vacancies-race-container">
                            <div class="vacancy-bars-wrapper">
                                <!-- Интерактивные полосы с вакансиями будут добавлены через JS -->
                                <div class="vacancy-item">
                                    <div class="vacancy-rank">1</div>
                                    <div class="vacancy-name">Разработчик ПО</div>
                                    <div class="vacancy-bar" style="width: 85%;">
                                        <div class="bar-fill" style="width: 85%;"></div>
                                    </div>
                                    <div class="vacancy-count">1,248</div>
                                    <div class="vacancy-growth positive">+14.5%</div>
                                </div>
                            </div>
                            <canvas id="topVacanciesChart"></canvas>
                        </div>
                        <div class="chart-footer">
                            <button class="text-sm text-blue-600 flex items-center">
                                <i class="fas fa-external-link mr-1"></i> Подробный отчет
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка "Аналитика" -->
            <div class="tab-content" id="analytics">
                <!-- Диаграммы аналитики -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Возрастное распределение</h3>
                        <div class="chart-wrapper">
                            <canvas id="ageDistributionChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Образовательная структура</h3>
                        <div class="chart-wrapper">
                            <canvas id="educationChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container lg:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Эффективность программ трудоустройства</h3>
                        <div class="chart-wrapper">
                            <canvas id="programEfficiencyChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Инструменты аналитики -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <div class="tool-card theme-analytics interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Трендовый анализ</h3>
                        <p class="text-gray-600 mb-4">Анализ исторических данных и выявление тенденций на рынке труда с использованием продвинутых алгоритмов.</p>
                        <button class="text-blue-600 font-semibold hover:text-blue-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="tool-card theme-statistics interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Анализ навыков</h3>
                        <p class="text-gray-600 mb-4">Выявление наиболее востребованных профессиональных навыков и анализ разрыва компетенций.</p>
                        <button class="text-green-600 font-semibold hover:text-green-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="tool-card theme-salaries interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Анализ зарплат</h3>
                        <p class="text-gray-600 mb-4">Комплексный анализ уровней заработной платы по профессиям, отраслям и регионам.</p>
                        <button class="text-cyan-600 font-semibold hover:text-cyan-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="tool-card theme-forecasting interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Сравнительный анализ</h3>
                        <p class="text-gray-600 mb-4">Сравнение показателей между регионами, отраслями и временными периодами.</p>
                        <button class="text-yellow-600 font-semibold hover:text-yellow-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="tool-card theme-migration interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-globe-asia"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Анализ миграции</h3>
                        <p class="text-gray-600 mb-4">Исследование трудовой миграции, направлений и экономического воздействия.</p>
                        <button class="text-red-600 font-semibold hover:text-red-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="tool-card theme-skills interactive-element">
                        <div class="tool-icon">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Анализ вакансий</h3>
                        <p class="text-gray-600 mb-4">Глубокий анализ динамики вакансий и требований работодателей.</p>
                        <button class="text-purple-600 font-semibold hover:text-purple-800 transition-colors">
                            Открыть инструмент <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- Расширенная аналитика -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Корреляционный анализ</h3>
                        <div class="chart-container">
                            <canvas id="correlationChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Тепловая карта активности</h3>
                        <div class="chart-container">
                            <canvas id="heatmapChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка "Прогнозирование" -->
            <div class="tab-content" id="forecasting">
                <!-- Диаграммы прогнозирования -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Прогноз уровня занятости</h3>
                        <div class="chart-wrapper">
                            <canvas id="employmentForecastChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Прогноз средних зарплат</h3>
                        <div class="chart-wrapper">
                            <canvas id="salaryForecastChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container lg:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Прогноз вакансий по секторам</h3>
                        <div class="chart-wrapper">
                            <canvas id="vacancyForecastChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Прогноз занятости на 2025 год</h3>
                        <div class="chart-container">
                            <canvas id="employmentForecastChart"></canvas>
                        </div>
                        <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                            <p class="text-sm text-blue-800">
                                <i class="fas fa-info-circle mr-2"></i>
                                Прогноз основан на анализе исторических данных и экономических трендов
                            </p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Прогноз по отраслям</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                <div>
                                    <div class="font-semibold text-green-800">ИТ и технологии</div>
                                    <div class="text-sm text-green-600">Ожидаемый рост</div>
                                </div>
                                <div class="text-2xl font-bold text-green-600">+15%</div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                <div>
                                    <div class="font-semibold text-blue-800">Образование</div>
                                    <div class="text-sm text-blue-600">Стабильный рост</div>
                                </div>
                                <div class="text-2xl font-bold text-blue-600">+8%</div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                <div>
                                    <div class="font-semibold text-yellow-800">Производство</div>
                                    <div class="text-sm text-yellow-600">Медленный рост</div>
                                </div>
                                <div class="text-2xl font-bold text-yellow-600">+3%</div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                                <div>
                                    <div class="font-semibold text-red-800">Сельское хозяйство</div>
                                    <div class="text-sm text-red-600">Снижение</div>
                                </div>
                                <div class="text-2xl font-bold text-red-600">-2%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Модель прогнозирования -->
                <div class="stat-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Настройки модели прогнозирования</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Горизонт прогноза</label>
                            <select class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="3">3 месяца</option>
                                <option value="6">6 месяцев</option>
                                <option value="12" selected>1 год</option>
                                <option value="24">2 года</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Модель</label>
                            <select class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="arima">ARIMA</option>
                                <option value="lstm" selected>LSTM нейросеть</option>
                                <option value="linear">Линейная регрессия</option>
                                <option value="ensemble">Ансамбль моделей</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Точность</label>
                            <div class="flex items-center p-3 bg-green-50 rounded-lg">
                                <div class="text-2xl font-bold text-green-600 mr-2">87.3%</div>
                                <div class="text-sm text-green-600">MAE: 2.1%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка "Миграция" -->
            <div class="tab-content" id="migration">
                <!-- Диаграммы миграции -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Внутренняя миграция</h3>
                        <div class="chart-wrapper">
                            <canvas id="internalMigrationChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Внешняя миграция по странам</h3>
                        <div class="chart-wrapper">
                            <canvas id="externalMigrationChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container lg:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Денежные переводы</h3>
                        <div class="chart-wrapper">
                            <canvas id="remittancesChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Миграционные потоки</h3>
                        <div class="chart-container">
                            <canvas id="migrationFlowChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">География миграции</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 border-l-4 border-blue-500 bg-blue-50">
                                <div>
                                    <div class="font-semibold">Россия</div>
                                    <div class="text-sm text-gray-600">Основное направление</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xl font-bold text-blue-600">847,230</div>
                                    <div class="text-sm text-gray-500">мигрантов</div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 border-l-4 border-green-500 bg-green-50">
                                <div>
                                    <div class="font-semibold">Казахстан</div>
                                    <div class="text-sm text-gray-600">Второе направление</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xl font-bold text-green-600">156,890</div>
                                    <div class="text-sm text-gray-500">мигрантов</div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 border-l-4 border-yellow-500 bg-yellow-50">
                                <div>
                                    <div class="font-semibold">Киргизия</div>
                                    <div class="text-sm text-gray-600">Третье направление</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xl font-bold text-yellow-600">89,450</div>
                                    <div class="text-sm text-gray-500">мигрантов</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Денежные переводы -->
                <div class="stat-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Денежные переводы</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="text-center p-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg">
                            <div class="text-3xl font-bold">$2.47B</div>
                            <div class="text-sm opacity-90">Общий объем</div>
                        </div>
                        <div class="text-center p-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg">
                            <div class="text-3xl font-bold">+12.5%</div>
                            <div class="text-sm opacity-90">Рост за год</div>
                        </div>
                        <div class="text-center p-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg">
                            <div class="text-3xl font-bold">$206</div>
                            <div class="text-sm opacity-90">На душу населения</div>
                        </div>
                        <div class="text-center p-4 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg">
                            <div class="text-3xl font-bold">31.2%</div>
                            <div class="text-sm opacity-90">% от ВВП</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка "Навыки" -->
            <div class="tab-content" id="skills">
                <!-- Диаграммы навыков -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Разрыв навыков: спрос vs предложение</h3>
                        <div class="chart-wrapper">
                            <canvas id="skillGapChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Анализ навыков по категориям</h3>
                        <div class="chart-wrapper">
                            <canvas id="skillCategoriesChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container lg:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Самые востребованные навыки</h3>
                        <div class="chart-wrapper">
                            <canvas id="topSkillsChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Востребованные навыки</h3>
                        <div class="chart-container">
                            <canvas id="skillsRadarChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Рейтинг навыков</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">1</div>
                                    <span class="font-medium">Программирование (Python)</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 95%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">95%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">2</div>
                                    <span class="font-medium">Анализ данных</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 88%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">88%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">3</div>
                                    <span class="font-medium">Цифровой маркетинг</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                        <div class="bg-purple-500 h-2 rounded-full" style="width: 82%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">82%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-yellow-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">4</div>
                                    <span class="font-medium">Управление проектами</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 75%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">75%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">5</div>
                                    <span class="font-medium">Кибербезопасность</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                        <div class="bg-red-500 h-2 rounded-full" style="width: 71%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">71%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Карта навыков -->
                <div class="stat-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Карта навыков по регионам</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <h4 class="font-semibold mb-2">Душанбе</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span>ИТ навыки</span>
                                    <span class="font-semibold text-blue-600">85%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Языки</span>
                                    <span class="font-semibold text-green-600">78%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Менеджмент</span>
                                    <span class="font-semibold text-purple-600">72%</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <h4 class="font-semibold mb-2">Согд</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span>Производство</span>
                                    <span class="font-semibold text-blue-600">82%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Логистика</span>
                                    <span class="font-semibold text-green-600">76%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Торговля</span>
                                    <span class="font-semibold text-purple-600">71%</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <h4 class="font-semibold mb-2">Хатлон</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span>Сельское хозяйство</span>
                                    <span class="font-semibold text-blue-600">88%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Пищевая индустрия</span>
                                    <span class="font-semibold text-green-600">74%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Строительство</span>
                                    <span class="font-semibold text-purple-600">69%</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <h4 class="font-semibold mb-2">РРП</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span>Добыча</span>
                                    <span class="font-semibold text-blue-600">79%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Энергетика</span>
                                    <span class="font-semibold text-green-600">73%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Туризм</span>
                                    <span class="font-semibold text-purple-600">65%</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <h4 class="font-semibold mb-2">ГБАО</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span>Туризм</span>
                                    <span class="font-semibold text-blue-600">81%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Ремесла</span>
                                    <span class="font-semibold text-green-600">77%</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span>Экология</span>
                                    <span class="font-semibold text-purple-600">70%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Футер -->
    <footer class="gradient-bg text-white py-12 mt-16">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">TOCO Analytics</h3>
                    <p class="text-gray-200 mb-4">Профессиональная панель аналитики рынка труда Республики Таджикистан.</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Инструменты</h3>
                    <ul class="space-y-2 text-gray-200">
                        <li><a href="#" class="hover:text-white">Дашборд</a></li>
                        <li><a href="#" class="hover:text-white">Аналитика</a></li>
                        <li><a href="#" class="hover:text-white">Прогнозирование</a></li>
                        <li><a href="#" class="hover:text-white">Отчеты</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Ресурсы</h3>
                    <ul class="space-y-2 text-gray-200">
                        <li><a href="#" class="hover:text-white">Документация</a></li>
                        <li><a href="#" class="hover:text-white">API</a></li>
                        <li><a href="#" class="hover:text-white">Поддержка</a></li>
                        <li><a href="#" class="hover:text-white">Обучение</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Контакты</h3>
                    <div class="space-y-2 text-gray-200">
                        <p><i class="fas fa-envelope mr-2"></i>analytics@toco.tj</p>
                        <p><i class="fas fa-phone mr-2"></i>+992 37 221-05-63</p>
                    </div>
                </div>
            </div>
            <div class="border-t border-white border-opacity-20 mt-8 pt-8 text-center">
                <p class="text-gray-300">© 2025 TOCO Analytics. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script>
        // Глобальные переменные
        let currentCharts = {};
        let analytics;
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация расширенной аналитики
            analytics = new AdvancedAnalytics();
            
            initializeMenus();
            initializeCharts();
            initializeTabs();
            initializeFilters();
            loadDashboardData();
            
            // Добавляем обработчик изменения размера окна
            window.addEventListener('resize', () => {
                analytics.resizeAllCharts();
            });
        });

        // Инициализация меню
        function initializeMenus() {
            const menuToggle = document.getElementById('menuToggle');
            const sideMenu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');
            const openFilters = document.getElementById('openFilters');
            const filterSidebar = document.getElementById('filterSidebar');
            const closeFilters = document.getElementById('closeFilters');

            // Боковое меню
            menuToggle.addEventListener('click', () => {
                sideMenu.classList.toggle('open');
                overlay.classList.toggle('active');
            });

            // Панель фильтров
            openFilters.addEventListener('click', () => {
                filterSidebar.classList.add('open');
                overlay.classList.add('active');
            });

            closeFilters.addEventListener('click', () => {
                filterSidebar.classList.remove('open');
                overlay.classList.remove('active');
            });

            // Закрытие при клике на затемнение
            overlay.addEventListener('click', () => {
                sideMenu.classList.remove('open');
                filterSidebar.classList.remove('open');
                overlay.classList.remove('active');
            });

            // Навигация по меню
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    if (item.getAttribute('href').startsWith('#')) {
                        e.preventDefault();
                        document.querySelectorAll('.menu-item').forEach(menuItem => {
                            menuItem.classList.remove('active');
                        });
                        item.classList.add('active');
                        
                        sideMenu.classList.remove('open');
                        overlay.classList.remove('active');
                    }
                });
            });
        }

        // Инициализация вкладок
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    
                    // Удаляем активные классы
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Добавляем активные классы
                    button.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                    
                    // Загружаем соответствующие данные для вкладки
                    loadTabData(targetTab);
                });
            });
        }

        // Загрузка данных для конкретной вкладки
        function loadTabData(tabName) {
            switch(tabName) {
                case 'analytics':
                    loadAnalyticsData();
                    break;
                case 'forecasting':
                    loadForecastingData();
                    break;
                case 'migration':
                    loadMigrationData();
                    break;
                case 'skills':
                    loadSkillsData();
                    break;
            }
        }

        // Загрузка данных аналитики
        function loadAnalyticsData() {
            if (typeof SampleData === 'undefined') return;
            
            // Создаем диаграмму по возрастным группам
            createAgeDistributionChart();
            
            // Создаем диаграмму по образованию
            createEducationChart();
            
            // Создаем диаграмму производительности программ
            createProgramEfficiencyChart();
            
            showNotification('Данные аналитики загружены', 'success');
        }

        // Загрузка данных прогнозирования
        function loadForecastingData() {
            if (typeof SampleData === 'undefined') return;
            
            // Создаем прогнозы занятости
            createEmploymentForecastChart();
            
            // Создаем прогнозы зарплат
            createSalaryForecastChart();
            
            // Создаем прогнозы по вакансиям
            createVacancyForecastChart();
            
            showNotification('Прогнозные данные загружены', 'success');
        }

        // Загрузка данных миграции
        function loadMigrationData() {
            if (typeof SampleData === 'undefined') return;
            
            // Создаем диаграмму внутренней миграции
            createInternalMigrationChart();
            
            // Создаем диаграмму внешней миграции
            createExternalMigrationChart();
            
            // Создаем диаграмму денежных переводов
            createRemittancesChart();
            
            showNotification('Данные миграции загружены', 'success');
        }

        // Загрузка данных навыков
        function loadSkillsData() {
            if (typeof SampleData === 'undefined') return;
            
            // Создаем диаграмму разрыва навыков
            createSkillGapChart();
            
            // Создаем диаграмму по категориям навыков
            createSkillCategoriesChart();
            
            // Создаем диаграмму самых востребованных навыков
            createTopSkillsChart();
            
            showNotification('Данные навыков загружены', 'success');
        }

        // Инициализация фильтров
        function initializeFilters() {
            const applyFilters = document.getElementById('applyFilters');
            const resetFilters = document.getElementById('resetFilters');

            applyFilters.addEventListener('click', () => {
                showLoadingOverlay();
                // Имитация применения фильтров
                setTimeout(() => {
                    hideLoadingOverlay();
                    updateChartsWithFilters();
                    document.getElementById('filterSidebar').classList.remove('open');
                    document.getElementById('overlay').classList.remove('active');
                    showNotification('Фильтры применены успешно', 'success');
                }, 1500);
            });

            resetFilters.addEventListener('click', () => {
                // Сброс всех фильтров
                document.getElementById('regionFilter').value = 'all';
                document.getElementById('periodFilter').value = 'month';
                document.getElementById('industryFilter').value = 'all';
                document.getElementById('educationFilter').value = 'all';
                
                const checkboxes = document.querySelectorAll('#filterSidebar input[type="checkbox"]');
                checkboxes.forEach(cb => cb.checked = false);
                
                showNotification('Фильтры сброшены', 'info');
            });
        }

        // Функции для загрузки
        function showLoadingOverlay() {
            const overlay = document.createElement('div');
            overlay.className = 'loading-overlay';
            overlay.innerHTML = '<div class="spinner"></div>';
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.zIndex = '9999';
            document.body.appendChild(overlay);
        }

        function hideLoadingOverlay() {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) overlay.remove();
        }

        // Инициализация диаграмм
        function initializeCharts() {
            // Получаем реальные данные если доступны
            const useRealData = typeof SampleData !== 'undefined';
            
            if (useRealData) {
                const metrics = SampleData.employmentMetrics;
                
                // Современные спидометры для ключевых метрик с реальными данными
                analytics.createModernGauge('employmentGauge', metrics.employmentRate, 100, {
                    color: '#3b82f6',
                    unit: '%'
                });
                
                analytics.createModernGauge('unemploymentGauge', metrics.unemploymentRate, 15, {
                    color: '#ef4444',
                    unit: '%'
                });
                
                analytics.createModernGauge('vacanciesGauge', (metrics.newVacancies / 2000 * 100), 100, {
                    color: '#10b981',
                    unit: '%'
                });
                
                analytics.createModernGauge('salaryGauge', (metrics.averageSalary / 5000 * 100), 100, {
                    color: '#f59e0b',
                    unit: '%'
                });
            } else {
                // Fallback к демонстрационным данным
                analytics.createModernGauge('employmentGauge', 75, 100, {
                    color: '#3b82f6',
                    unit: '%'
                });
                
                analytics.createModernGauge('unemploymentGauge', 7.2, 15, {
                    color: '#ef4444',
                    unit: '%'
                });
                
                analytics.createModernGauge('vacanciesGauge', 65, 100, {
                    color: '#10b981',
                    unit: '%'
                });
                
                analytics.createModernGauge('salaryGauge', 45, 100, {
                    color: '#f59e0b',
                    unit: '%'
                });
            }

            // Основные диаграммы
            createEmploymentTrendChart();
            createIndustryDistributionChart();
            createRegionalStatsChart();
            createTopVacanciesChart();
        }

        // Создание графика динамики занятости
        function createEmploymentTrendChart() {
            const useRealData = typeof SampleData !== 'undefined';
            
            let data;
            if (useRealData) {
                const trends = SampleData.monthlyTrends;
                data = {
                    labels: trends.labels,
                    datasets: [{
                        label: 'Занятость (%)',
                        data: trends.employment,
                        fill: true
                    }]
                };
            } else {
                data = {
                    labels: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],
                    datasets: [{
                        label: 'Занятость (тыс. человек)',
                        data: [1820, 1825, 1830, 1835, 1840, 1842, 1845, 1847, 1849, 1851, 1848, 1847],
                        fill: true
                    }]
                };
            }

            currentCharts.employmentTrend = analytics.createAdvancedLineChart('employmentTrendChart', data);
        }

        // Создание диаграммы распределения по отраслям
        function createIndustryDistributionChart() {
            const useRealData = typeof SampleData !== 'undefined';
            
            let data;
            if (useRealData) {
                const industries = SampleData.industryData;
                data = {
                    labels: industries.labels.slice(0, 6), // Берем первые 6 отраслей
                    values: industries.employment.slice(0, 6).map(val => Math.round(val / 10000)) // Приводим к процентам
                };
            } else {
                data = {
                    labels: ['Сельское хозяйство', 'Производство', 'Услуги', 'ИТ', 'Строительство', 'Образование'],
                    values: [35, 20, 18, 12, 10, 5]
                };
            }

            currentCharts.industryDistribution = analytics.createInteractivePieChart('industryDistributionChart', data);
        }

        // Создание региональной статистики
        function createRegionalStatsChart() {
            const useRealData = typeof SampleData !== 'undefined';
            
            let data;
            if (useRealData) {
                const regional = SampleData.regionalData;
                data = {
                    labels: regional.labels,
                    datasets: [{
                        label: 'Занятость (тыс.)',
                        data: regional.employment.map(item => Math.round(item.employed / 1000))
                    }]
                };
            } else {
                data = {
                    labels: ['Душанбе', 'РРП', 'Согд', 'Хатлон', 'ГБАО'],
                    datasets: [{
                        label: 'Занятость (тыс.)',
                        data: [450, 520, 380, 420, 77]
                    }]
                };
            }

            currentCharts.regionalStats = analytics.createBarChart('regionalStatsChart', data);
        }

        // Создание топ вакансий
        function createTopVacanciesChart() {
            const ctx = document.getElementById('topVacanciesChart');
            if (!ctx) return;

            const data = {
                labels: ['Продавец', 'Водитель', 'Программист', 'Учитель', 'Врач', 'Строитель', 'Бухгалтер', 'Менеджер', 'Повар', 'Охранник'],
                datasets: [{
                    label: 'Количество вакансий',
                    data: [2450, 1890, 1650, 1420, 1280, 1150, 980, 850, 750, 650],
                    backgroundColor: 'rgba(16, 185, 129, 0.8)',
                    borderColor: '#10b981',
                    borderWidth: 1
                }]
            };

            currentCharts.topVacancies = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#10b981',
                            borderWidth: 1,
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { 
                                color: '#f3f4f6',
                                borderColor: '#e5e7eb'
                            },
                            ticks: {
                                font: {
                                    family: 'Inter',
                                    size: 11
                                }
                            }
                        },
                        y: {
                            grid: { display: false },
                            ticks: {
                                font: {
                                    family: 'Inter',
                                    size: 11
                                }
                            }
                        }
                    },
                    onHover: (event, activeElements) => {
                        event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }

        // Загрузка данных аналитики
        function loadAnalyticsData() {
            // Создание корреляционного анализа
            setTimeout(() => {
                createCorrelationChart();
                createHeatmapChart();
            }, 100);
        }

        // Создание корреляционного графика
        function createCorrelationChart() {
            const ctx = document.getElementById('correlationChart');
            if (!ctx) return;

            const data = {
                datasets: [{
                    label: 'Корреляция зарплаты и образования',
                    data: [
                        {x: 1, y: 1800}, {x: 2, y: 2200}, {x: 3, y: 2800},
                        {x: 4, y: 3400}, {x: 5, y: 4200}, {x: 6, y: 5100}
                    ],
                    backgroundColor: 'rgba(79, 70, 229, 0.6)',
                    borderColor: '#4f46e5',
                    borderWidth: 2
                }]
            };

            new Chart(ctx, {
                type: 'scatter',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#4f46e5',
                            borderWidth: 1,
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Уровень образования'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Средняя зарплата (сомони)'
                            }
                        }
                    }
                }
            });
        }

        // Создание тепловой карты
        function createHeatmapChart() {
            const canvas = document.getElementById('heatmapChart');
            if (!canvas) return;
            
            // Данные для тепловой карты (активность по дням недели и часам)
            const heatmapData = [
                [1.2, 2.1, 3.4, 4.5, 5.6, 4.3, 3.2],
                [2.3, 3.2, 4.1, 5.8, 6.2, 5.1, 4.0],
                [3.1, 4.3, 5.2, 6.7, 7.1, 6.3, 5.2],
                [2.8, 3.9, 4.8, 6.1, 6.8, 5.9, 4.7],
                [1.9, 2.7, 3.6, 4.9, 5.4, 4.6, 3.5]
            ];
            
            analytics.createHeatmapChart('heatmapChart', heatmapData);
        }

        // Загрузка данных дашборда
        function loadDashboardData() {
            // Загружаем данные из конфигурации
            if (typeof SampleData !== 'undefined' && typeof SampleDataUtils !== 'undefined') {
                const summary = SampleDataUtils.getDashboardSummary();
                updateMetricsWithRealData(summary);
            } else {
                // Fallback к демонстрационным данным
                updateMetrics();
                // Загружаем мини-диаграммы с демонстрационными данными
                loadMiniCharts();
            }
        }

        // Обновление метрик с реальными данными
        function updateMetricsWithRealData(summary) {
            // Анимация счетчиков с реальными данными
            animateCounter('totalEmployment', summary.totalEmployed);
            animateCounter('activeVacancies', summary.activeVacancies);
            animateCounter('averageSalary', summary.averageSalary);
            animatePercentage('unemploymentRate', summary.unemploymentRate);
            
            // Обновляем дополнительные показатели
            updateStatCard('employment-rate', summary.employmentRate, '%', 'up');
            updateStatCard('total-population', 2400000, '', 'stable');
            updateStatCard('labor-force', summary.totalEmployed, '', 'up');
            updateStatCard('job-seekers', summary.activeVacancies, '', 'down');
            
            // Загружаем мини-диаграммы
            loadMiniCharts();
        }

        // Обновление метрик
        function updateMetrics() {
            // Анимация счетчиков
            animateCounter('totalEmployment', 1847230);
            animateCounter('activeVacancies', 23456);
            animateCounter('averageSalary', 2847);
        }

        // Обновление статистических карточек
        function updateStatCard(cardId, value, unit, trend) {
            const card = document.querySelector(`[data-stat="${cardId}"]`);
            if (!card) return;
            
            const valueElement = card.querySelector('.stat-value');
            const trendElement = card.querySelector('.trend-indicator');
            
            if (valueElement) {
                if (unit === '%') {
                    valueElement.textContent = value.toFixed(1) + unit;
                } else {
                    valueElement.textContent = AnalyticsUtils.formatNumber(value);
                }
            }
            
            if (trendElement) {
                trendElement.className = `trend-indicator trend-${trend}`;
                const icon = trend === 'up' ? 'fa-arrow-up' : 
                           trend === 'down' ? 'fa-arrow-down' : 'fa-minus';
                trendElement.innerHTML = `<i class="fas ${icon}"></i>`;
            }
        }

        // Загрузка мини-диаграмм в карточки
        function loadMiniCharts() {
            // Данные для мини-графиков
            if (typeof SampleData !== 'undefined' && SampleData.monthlyTrends) {
                // Используем реальные данные если доступны
                createMiniLineChart('employment-trend-mini', SampleData.monthlyTrends.employment);
                createMiniLineChart('vacancies-trend-mini', SampleData.monthlyTrends.vacancies);
                createMiniBarChart('regional-mini', SampleData.regionalData.employment.map(r => r.rate));
                createMiniDoughnutChart('industries-mini', SampleData.industryData.employment.slice(0, 5));
            } else {
                // Используем демонстрационные данные
                // Данные для тренда занятости (рост)
                const employmentData = [70, 72, 75, 78, 80, 82, 85, 87, 90, 93, 95];
                createMiniLineChart('employment-trend-mini', employmentData);
                
                // Данные для трудовых ресурсов (стабильно)
                const laborData = [2.3, 2.4, 2.4, 2.35, 2.4, 2.45, 2.4, 2.35, 2.4, 2.4, 2.4];
                createMiniLineChart('vacancies-trend-mini', laborData);
                
                // Данные по регионам
                const regionData = [65, 48, 75, 60, 80];
                createMiniBarChart('regional-mini', regionData);
                
                // Данные по отраслям
                const industryData = [30, 25, 20, 15, 10];
                createMiniDoughnutChart('industries-mini', industryData);
            }
            
            // Делаем карточки интерактивными
            initializeEnhancedCards();
            
            // Запускаем периодические обновления для создания эффекта "live"
            startLiveUpdates();
        }
        
        // Инициализация интерактивных карточек
        function initializeEnhancedCards() {
            // Добавляем обработчики событий для всех карточек
            document.querySelectorAll('.stat-card-enhanced').forEach(card => {
                // Добавляем эффект клика
                card.addEventListener('click', function() {
                    // Покажем подробную информацию по карточке
                    const statType = this.getAttribute('data-stat');
                    showDetailedView(statType);
                });
                
                // Добавляем эффект наведения на индикатор LIVE
                const liveIndicator = card.querySelector('.live-indicator');
                if (liveIndicator) {
                    liveIndicator.addEventListener('click', function(event) {
                        event.stopPropagation(); // Предотвращаем срабатывание клика на родительской карточке
                        toggleLiveUpdates(this.closest('.stat-card-enhanced').getAttribute('data-stat'));
                    });
                }
            });
        }
        
        // Показ детального представления для карточки
        function showDetailedView(statType) {
            let title, description;
            
            switch(statType) {
                case 'employment-rate':
                    title = 'Детальный тренд занятости';
                    description = 'Подробная информация о динамике занятости за последние 12 месяцев, включая сезонные колебания и тенденции.';
                    break;
                case 'total-population':
                    title = 'Анализ трудовых ресурсов';
                    description = 'Распределение трудоспособного населения по возрастам, образованию и другим характеристикам.';
                    break;
                case 'labor-force':
                    title = 'Распределение по регионам';
                    description = 'Детальный анализ занятости и экономической активности по регионам республики.';
                    break;
                case 'job-seekers':
                    title = 'Анализ по отраслям';
                    description = 'Распределение рабочих мест и занятости по секторам экономики.';
                    break;
                default:
                    title = 'Подробная информация';
                    description = 'Детальный анализ выбранного показателя.';
            }
            
            // Здесь может быть код для отображения модального окна или переход на страницу с детальной информацией
            alert(`${title}\n${description}\n\nДля полного анализа перейдите в раздел аналитики.`);
        }
        
        // Запуск периодических обновлений для создания эффекта "live"
        function startLiveUpdates() {
            // Обновление данных каждые 5-10 секунд
            setInterval(function() {
                // Выбираем случайную карточку для обновления
                const cards = ['employment-rate', 'total-population', 'labor-force', 'job-seekers'];
                const randomCard = cards[Math.floor(Math.random() * cards.length)];
                
                // Генерируем небольшое изменение в данных
                updateCardData(randomCard);
            }, 5000 + Math.random() * 5000); // Случайный интервал от 5 до 10 секунд
        }
        
        // Обновление данных для карточки
        function updateCardData(cardType) {
            const card = document.querySelector(`[data-stat="${cardType}"]`);
            if (!card) return;
            
            // Генерируем небольшое изменение для значения
            const valueElement = card.querySelector('.stat-value');
            if (valueElement) {
                let currentValue = parseFloat(valueElement.innerText);
                if (isNaN(currentValue)) {
                    // Если текст содержит не только число (например, "2.4М")
                    currentValue = parseFloat(valueElement.innerText.replace(/[^\d.-]/g, ''));
                }
                
                // Генерируем изменение в пределах ±2%
                const change = (Math.random() * 4 - 2) / 100;
                const newValue = currentValue * (1 + change);
                
                // Форматируем в зависимости от типа карточки
                if (cardType === 'employment-rate') {
                    valueElement.innerText = newValue.toFixed(1) + '%';
                } else if (cardType === 'total-population') {
                    valueElement.innerText = newValue.toFixed(1) + 'М';
                } else {
                    valueElement.innerText = Math.round(newValue);
                }
                
                // Добавляем эффект подсветки при обновлении
                valueElement.classList.add('highlight-update');
                setTimeout(() => {
                    valueElement.classList.remove('highlight-update');
                }, 1000);
            }
            
            // Также можно обновить мини-графики для создания эффекта живых данных
            updateMiniChart(cardType);
        }
        
        // Обновление мини-графика
        function updateMiniChart(cardType) {
            let canvasId;
            switch(cardType) {
                case 'employment-rate': canvasId = 'employment-trend-mini'; break;
                case 'total-population': canvasId = 'vacancies-trend-mini'; break;
                case 'labor-force': canvasId = 'regional-mini'; break;
                case 'job-seekers': canvasId = 'industries-mini'; break;
                default: return;
            }
            
            const chartInstance = Chart.getChart(canvasId);
            if (chartInstance) {
                // Для линейных графиков добавляем новую точку
                if (chartInstance.config.type === 'line') {
                    const lastValue = chartInstance.data.datasets[0].data[chartInstance.data.datasets[0].data.length - 1];
                    const newValue = lastValue * (1 + (Math.random() * 0.06 - 0.03));
                    
                    chartInstance.data.datasets[0].data.shift(); // Убираем первую точку
                    chartInstance.data.datasets[0].data.push(newValue); // Добавляем новую точку
                    chartInstance.update();
                }
                // Для других типов графиков можно реализовать свою логику обновления
            }
        }
        
        // Включение/выключение живых обновлений для карточки
        function toggleLiveUpdates(cardType) {
            const card = document.querySelector(`[data-stat="${cardType}"]`);
            if (!card) return;
            
            const liveIndicator = card.querySelector('.live-indicator');
            if (liveIndicator) {
                const isActive = liveIndicator.classList.contains('active');
                
                if (isActive) {
                    liveIndicator.classList.remove('active');
                    liveIndicator.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
                    liveIndicator.style.color = '#3b82f6';
                } else {
                    liveIndicator.classList.add('active');
                    liveIndicator.style.backgroundColor = '#3b82f6';
                    liveIndicator.style.color = 'white';
                }
            }
        }

        // Анимация счетчика
        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            let current = 0;
            const increment = targetValue / 100;
            const timer = setInterval(() => {
                current += increment;
                if (current >= targetValue) {
                    current = targetValue;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current).toLocaleString('ru-RU');
            }, 20);
        }

        // Создание мини-диаграммы линейного типа
        function createMiniLineChart(canvasId, data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map((_, i) => i + 1),
                    datasets: [{
                        data: data,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    scales: {
                        x: { display: false },
                        y: { display: false }
                    },
                    elements: {
                        point: { radius: 0 }
                    }
                }
            });
        }

        // Создание мини-диаграммы столбчатого типа
        function createMiniBarChart(canvasId, data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map((_, i) => i + 1),
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'
                        ],
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    scales: {
                        x: { display: false },
                        y: { display: false }
                    }
                }
            });
        }

        // Создание мини-диаграммы кольцевого типа
        function createMiniDoughnutChart(canvasId, data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    cutout: '70%'
                }
            });
        }

        // Обновление диаграмм с фильтрами
        function updateChartsWithFilters() {
            const region = document.getElementById('regionFilter').value;
            const period = document.getElementById('periodFilter').value;
            const industry = document.getElementById('industryFilter').value;
            
            // Пример обновления данных на основе фильтров
            if (currentCharts.employmentTrend) {
                const newData = {
                    datasets: [{
                        data: generateRandomData(12, 1800000, 1900000)
                    }]
                };
                analytics.animateChartUpdate('employmentTrendChart', newData);
            }
            
            console.log(`Обновление диаграмм для региона: ${region}, периода: ${period}, отрасли: ${industry}`);
        }

        // Генерация случайных данных для демонстрации
        function generateRandomData(count, min, max) {
            return Array.from({ length: count }, () => 
                Math.floor(Math.random() * (max - min + 1)) + min
            );
        }

        // Функции загрузки данных для вкладок
        function loadForecastingData() {
            console.log('Загрузка данных прогнозирования');
            setTimeout(() => {
                createEmploymentForecastChart();
            }, 100);
        }

        function loadMigrationData() {
            console.log('Загрузка данных миграции');
            setTimeout(() => {
                createMigrationFlowChart();
            }, 100);
        }

        function loadSkillsData() {
            console.log('Загрузка данных навыков');
            setTimeout(() => {
                createSkillsRadarChart();
            }, 100);
        }

        // Создание графика прогноза занятости
        function createEmploymentForecastChart() {
            const ctx = document.getElementById('employmentForecastChart');
            if (!ctx) return;

            const historicalData = [1820, 1825, 1830, 1835, 1840, 1842, 1845, 1847];
            const forecastData = [1850, 1855, 1862, 1868, 1875, 1881, 1888, 1895];

            const data = {
                labels: ['Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек', 'Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг'],
                datasets: [
                    {
                        label: 'Исторические данные',
                        data: [...historicalData, ...Array(8).fill(null)],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5
                    },
                    {
                        label: 'Прогноз',
                        data: [...Array(8).fill(null), ...forecastData],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        borderDash: [10, 5],
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5
                    }
                ]
            };

            new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { family: 'Inter', size: 12 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#4f46e5',
                            borderWidth: 1,
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#f3f4f6' },
                            ticks: { font: { family: 'Inter', size: 11 } }
                        },
                        y: {
                            grid: { color: '#f3f4f6' },
                            ticks: { 
                                font: { family: 'Inter', size: 11 },
                                callback: function(value) {
                                    return value + ' тыс.';
                                }
                            }
                        }
                    },
                    animation: { duration: 1500 }
                }
            });
        }

        // Создание графика миграционных потоков
        function createMigrationFlowChart() {
            const ctx = document.getElementById('migrationFlowChart');
            if (!ctx) return;

            const data = {
                labels: ['2020', '2021', '2022', '2023', '2024'],
                datasets: [
                    {
                        label: 'Эмиграция',
                        data: [320000, 295000, 280000, 310000, 335000],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Возвращение мигрантов',
                        data: [45000, 52000, 38000, 41000, 48000],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }
                ]
            };

            new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { family: 'Inter', size: 12 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#4f46e5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y.toLocaleString()} человек`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#f3f4f6' },
                            ticks: { font: { family: 'Inter', size: 11 } }
                        },
                        y: {
                            grid: { color: '#f3f4f6' },
                            ticks: {
                                font: { family: 'Inter', size: 11 },
                                callback: function(value) {
                                    return (value / 1000) + 'K';
                                }
                            }
                        }
                    },
                    animation: { duration: 1500 }
                }
            });
        }

        // Создание радарной диаграммы навыков
        function createSkillsRadarChart() {
            const ctx = document.getElementById('skillsRadarChart');
            if (!ctx) return;

            const data = {
                labels: [
                    'Программирование',
                    'Анализ данных',
                    'Цифровой маркетинг',
                    'Управление проектами',
                    'Кибербезопасность',
                    'Дизайн',
                    'Продажи',
                    'Языки'
                ],
                datasets: [
                    {
                        label: 'Спрос',
                        data: [95, 88, 82, 75, 71, 65, 78, 70],
                        borderColor: '#4f46e5',
                        backgroundColor: 'rgba(79, 70, 229, 0.2)',
                        borderWidth: 2,
                        pointBackgroundColor: '#4f46e5',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    },
                    {
                        label: 'Предложение',
                        data: [45, 52, 68, 58, 35, 72, 85, 78],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        borderWidth: 2,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }
                ]
            };

            new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { family: 'Inter', size: 12 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#4f46e5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.r}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: '#f3f4f6' },
                            pointLabels: {
                                font: { family: 'Inter', size: 11 }
                            },
                            ticks: {
                                stepSize: 20,
                                font: { family: 'Inter', size: 10 },
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    animation: { duration: 1500 }
                }
            });
        }

        // Экспорт данных
        document.getElementById('exportData').addEventListener('click', () => {
            const exportMenu = document.createElement('div');
            exportMenu.className = 'fixed top-20 right-6 bg-white rounded-lg shadow-xl p-4 z-50 border';
            exportMenu.innerHTML = `
                <h3 class="font-semibold mb-3">Экспорт данных</h3>
                <div class="space-y-2">
                    <button onclick="exportAs('pdf')" class="w-full text-left px-3 py-2 hover:bg-gray-100 rounded">
                        <i class="fas fa-file-pdf mr-2 text-red-500"></i>PDF отчет
                    </button>
                    <button onclick="exportAs('excel')" class="w-full text-left px-3 py-2 hover:bg-gray-100 rounded">
                        <i class="fas fa-file-excel mr-2 text-green-500"></i>Excel файл
                    </button>
                    <button onclick="exportAs('csv')" class="w-full text-left px-3 py-2 hover:bg-gray-100 rounded">
                        <i class="fas fa-file-csv mr-2 text-blue-500"></i>CSV данные
                    </button>
                    <button onclick="exportAs('image')" class="w-full text-left px-3 py-2 hover:bg-gray-100 rounded">
                        <i class="fas fa-image mr-2 text-purple-500"></i>Изображения графиков
                    </button>
                </div>
            `;
            
            document.body.appendChild(exportMenu);
            
            // Удаление меню через 5 секунд или при клике вне его
            setTimeout(() => exportMenu.remove(), 5000);
            
            document.addEventListener('click', function closeMenu(e) {
                if (!exportMenu.contains(e.target)) {
                    exportMenu.remove();
                    document.removeEventListener('click', closeMenu);
                }
            });
        });

        // Функция экспорта
        function exportAs(format) {
            showNotification(`Экспорт в формате ${format.toUpperCase()} начался. Файл будет загружен через несколько секунд.`, 'success');
            
            if (format === 'image') {
                // Экспорт всех диаграмм как изображений
                Object.keys(currentCharts).forEach(chartId => {
                    analytics.exportChart(chartId, `${chartId}_${new Date().getTime()}.png`);
                });
            }
        }

        // Функция уведомлений
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
            } text-white max-w-sm`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Анимация появления
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Автоудаление через 5 секунд
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // Добавляем интерактивность к карточкам инструментов
        document.addEventListener('click', function(e) {
            if (e.target.closest('.tool-card')) {
                const card = e.target.closest('.tool-card');
                const toolName = card.querySelector('h3').textContent;
                showNotification(`Инструмент "${toolName}" будет доступен в полной версии`, 'info');
            }
        });

        // === ДИАГРАММЫ ДЛЯ РАЗДЕЛА АНАЛИТИКИ ===
        
        // Создание диаграммы возрастного распределения
        function createAgeDistributionChart() {
            const canvas = document.getElementById('ageDistributionChart');
            if (!canvas) return;
            
            const ageData = SampleData.ageDistribution;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ageData.labels,
                    datasets: [{
                        label: 'Трудоустроенные',
                        data: ageData.employed,
                        backgroundColor: '#3b82f6',
                        borderRadius: 8
                    }, {
                        label: 'Безработные',
                        data: ageData.unemployed,
                        backgroundColor: '#ef4444',
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Распределение по возрастным группам',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Количество человек'
                            }
                        }
                    }
                }
            });
        }

        // Создание диаграммы по образованию
        function createEducationChart() {
            const canvas = document.getElementById('educationChart');
            if (!canvas) return;
            
            const eduData = SampleData.educationDistribution;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: eduData.labels,
                    datasets: [{
                        data: eduData.employed,
                        backgroundColor: [
                            '#ef4444', '#f59e0b', '#10b981', '#3b82f6', '#8b5cf6'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Распределение по уровню образования',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        // Создание диаграммы эффективности программ
        function createProgramEfficiencyChart() {
            const canvas = document.getElementById('programEfficiencyChart');
            if (!canvas) return;
            
            const programs = SampleDataUtils.calculateProgramEfficiency();
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Программы трудоустройства',
                        data: programs.map(p => ({
                            x: p.completionRate,
                            y: p.successRate,
                            r: p.participants / 1000
                        })),
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: '#3b82f6',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Эффективность программ трудоустройства',
                            font: { size: 16, weight: 'bold' }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const program = programs[context.dataIndex];
                                    return `${program.name}: ${context.parsed.y}% успеха, ${context.parsed.x}% завершения`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Процент завершения (%)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Процент трудоустройства (%)'
                            }
                        }
                    }
                }
            });
        }

        // === ДИАГРАММЫ ДЛЯ РАЗДЕЛА ПРОГНОЗИРОВАНИЯ ===
        
        // Создание прогноза занятости
        function createEmploymentForecastChart() {
            const canvas = document.getElementById('employmentForecastChart');
            if (!canvas) return;
            
            const forecast = SampleData.forecastData.employment;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: forecast.labels,
                    datasets: [{
                        label: 'Оптимистичный сценарий',
                        data: forecast.optimistic,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: false,
                        tension: 0.4
                    }, {
                        label: 'Реалистичный сценарий',
                        data: forecast.realistic,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: false,
                        tension: 0.4
                    }, {
                        label: 'Пессимистичный сценарий',
                        data: forecast.pessimistic,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        fill: false,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Прогноз уровня занятости',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Уровень занятости (%)'
                            }
                        }
                    }
                }
            });
        }

        // Создание прогноза зарплат
        function createSalaryForecastChart() {
            const canvas = document.getElementById('salaryForecastChart');
            if (!canvas) return;
            
            const salaries = SampleData.forecastData.salaries;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: salaries.labels,
                    datasets: [{
                        label: 'Средняя зарплата',
                        data: salaries.average,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'ИТ сектор',
                        data: salaries.it,
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        fill: false,
                        tension: 0.4
                    }, {
                        label: 'Сельское хозяйство',
                        data: salaries.agriculture,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: false,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Прогноз средних зарплат по секторам',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Зарплата (сомони)'
                            }
                        }
                    }
                }
            });
        }

        // Создание прогноза вакансий
        function createVacancyForecastChart() {
            const canvas = document.getElementById('vacancyForecastChart');
            if (!canvas) return;
            
            const vacancies = SampleData.forecastData.vacancies;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: vacancies.labels,
                    datasets: [{
                        label: 'ИТ',
                        data: vacancies.it,
                        backgroundColor: '#8b5cf6',
                        borderRadius: 8
                    }, {
                        label: 'Услуги',
                        data: vacancies.services,
                        backgroundColor: '#3b82f6',
                        borderRadius: 8
                    }, {
                        label: 'Производство',
                        data: vacancies.manufacturing,
                        backgroundColor: '#f59e0b',
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Прогноз количества вакансий по кварталам',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Количество вакансий'
                            }
                        }
                    }
                }
            });
        }

        // === ДИАГРАММЫ ДЛЯ РАЗДЕЛА МИГРАЦИИ ===
        
        // Создание диаграммы внутренней миграции
        function createInternalMigrationChart() {
            const canvas = document.getElementById('internalMigrationChart');
            if (!canvas) return;
            
            const migration = SampleData.migrationData.internal;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: migration.labels,
                    datasets: [{
                        label: 'Приток',
                        data: migration.inflow,
                        backgroundColor: '#10b981',
                        borderRadius: 8
                    }, {
                        label: 'Отток',
                        data: migration.outflow,
                        backgroundColor: '#ef4444',
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Внутренняя миграция',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Количество человек'
                            }
                        }
                    }
                }
            });
        }

        // Создание диаграммы внешней миграции
        function createExternalMigrationChart() {
            const canvas = document.getElementById('externalMigrationChart');
            if (!canvas) return;
            
            const external = SampleData.migrationData.external;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: external.labels,
                    datasets: [{
                        label: 'Эмигранты',
                        data: external.emigrants,
                        backgroundColor: [
                            '#3b82f6', '#10b981', '#f59e0b', '#ef4444'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Внешняя миграция по странам',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Создание диаграммы денежных переводов
        function createRemittancesChart() {
            const canvas = document.getElementById('remittancesChart');
            if (!canvas) return;
            
            const external = SampleData.migrationData.external;
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: external.labels,
                    datasets: [{
                        label: 'Денежные переводы (млн сомони)',
                        data: external.remittances.map(val => val / 1000000),
                        backgroundColor: '#f59e0b',
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Денежные переводы по странам',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Млн сомони'
                            }
                        }
                    }
                }
            });
        }

        // === ДИАГРАММЫ ДЛЯ РАЗДЕЛА НАВЫКОВ ===
        
        // Создание диаграммы разрыва навыков
        function createSkillGapChart() {
            const canvas = document.getElementById('skillGapChart');
            if (!canvas) return;
            
            const skillGaps = SampleDataUtils.getTopSkillGaps();
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: skillGaps.map(s => s.skill),
                    datasets: [{
                        label: 'Спрос',
                        data: skillGaps.map(s => s.demand),
                        backgroundColor: '#ef4444',
                        borderRadius: 8
                    }, {
                        label: 'Предложение',
                        data: skillGaps.map(s => s.supply),
                        backgroundColor: '#10b981',
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Разрыв между спросом и предложением навыков',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Процент (%)'
                            }
                        }
                    }
                }
            });
        }

        // Создание диаграммы категорий навыков
        function createSkillCategoriesChart() {
            const canvas = document.getElementById('skillCategoriesChart');
            if (!canvas) return;
            
            const categories = SampleData.skillsAnalysis.byCategory;
            const ctx = canvas.getContext('2d');
            
            const categoryNames = Object.keys(categories);
            const totalData = categoryNames.map(cat => categories[cat].total);
            const certifiedData = categoryNames.map(cat => categories[cat].certified);
            const inDemandData = categoryNames.map(cat => categories[cat].inDemand);
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Технические', 'Гибкие', 'Цифровые', 'Языковые'],
                    datasets: [{
                        label: 'Имеющиеся',
                        data: totalData,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        fill: true
                    }, {
                        label: 'Сертифицированные',
                        data: certifiedData,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        fill: true
                    }, {
                        label: 'Востребованные',
                        data: inDemandData,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Анализ навыков по категориям',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Количество специалистов (тыс.)'
                            }
                        }
                    }
                }
            });
        }

        // Создание диаграммы топ навыков
        function createTopSkillsChart() {
            const canvas = document.getElementById('topSkillsChart');
            if (!canvas) return;
            
            const topSkills = SampleData.skillsAnalysis.mostDemanded.slice(0, 8);
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topSkills.map(s => s.skill),
                    datasets: [{
                        label: 'Уровень спроса',
                        data: topSkills.map(s => s.demand),
                        backgroundColor: '#3b82f6',
                        borderRadius: 8
                    }]
                },
                options: {
                    indexAxis: 'y', // Это делает столбцы горизонтальными
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Самые востребованные навыки',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Уровень спроса (%)'
                            }
                        }
                    }
                }
            });
        }
    </script>
    
    <script>
        // Функция для инициализации карточек с биржевыми графиками
        function initializeStockCharts() {
            const statCards = document.querySelectorAll('.stat-card-enhanced');
            
            statCards.forEach((card) => {
                const statType = card.dataset.stat;
                const chartContainer = card.querySelector('.chart-mini');
                
                // Очищаем контейнер
                chartContainer.innerHTML = '';
                
                // Создаем структуру биржевого графика
                const stockChart = document.createElement('div');
                stockChart.className = 'stock-chart';
                
                // Добавляем сетку
                const chartGrid = document.createElement('div');
                chartGrid.className = 'chart-grid';
                
                for (let i = 0; i < 4; i++) {
                    const gridLine = document.createElement('div');
                    gridLine.className = 'chart-grid-line';
                    chartGrid.appendChild(gridLine);
                }
                
                stockChart.appendChild(chartGrid);
                
                // Генерируем начальные данные
                const data = generateStockData(20);
                
                // Создаем свечи и линию
                data.forEach((value, index) => {
                    // Свеча
                    const candle = document.createElement('div');
                    candle.className = 'chart-candle';
                    if (index > 0 && value < data[index - 1]) {
                        candle.classList.add('down');
                    }
                    
                    candle.style.height = `${value}%`;
                    candle.style.left = `${index * 5}%`;
                    stockChart.appendChild(candle);
                    
                    // Точка на линии
                    if (index < data.length - 1) {
                        const line = document.createElement('div');
                        line.className = 'chart-line';
                        line.style.height = '2px';
                        line.style.bottom = `${value}%`;
                        line.style.left = `${index * 5}%`;
                        line.style.width = '5%';
                        stockChart.appendChild(line);
                    }
                    
                    const point = document.createElement('div');
                    point.className = 'chart-point';
                    point.style.bottom = `${value}%`;
                    point.style.left = `${index * 5}%`;
                    stockChart.appendChild(point);
                });
                
                // Индикатор изменения
                const valueChange = document.createElement('div');
                valueChange.className = 'value-change';
                const lastTwoValues = data.slice(-2);
                const changePercent = ((lastTwoValues[1] - lastTwoValues[0]) / lastTwoValues[0] * 100).toFixed(2);
                
                if (changePercent >= 0) {
                    valueChange.classList.add('up');
                    valueChange.textContent = `+${changePercent}%`;
                } else {
                    valueChange.classList.add('down');
                    valueChange.textContent = `${changePercent}%`;
                }
                
                stockChart.appendChild(valueChange);
                chartContainer.appendChild(stockChart);
                
                // Сохраняем данные в атрибуте для последующих обновлений
                chartContainer.dataset.chartData = JSON.stringify(data);
            });
        }
        
        // Функция для генерации случайных данных для графика
        function generateStockData(points) {
            const data = [];
            let value = Math.random() * 40 + 30; // Начальное значение от 30% до 70%
            
            for (let i = 0; i < points; i++) {
                // Случайное изменение в пределах ±8%
                const change = (Math.random() - 0.5) * 16;
                value += change;
                
                // Ограничиваем значения от 10% до 90%
                value = Math.max(10, Math.min(90, value));
                
                data.push(value);
            }
            
            return data;
        }
        
        // Функция для обновления графиков в реальном времени
        function updateStockCharts() {
            const statCards = document.querySelectorAll('.stat-card-enhanced');
            
            statCards.forEach((card) => {
                const chartContainer = card.querySelector('.chart-mini');
                const statValue = card.querySelector('.stat-value');
                const currentData = JSON.parse(chartContainer.dataset.chartData);
                
                // Удаляем первый элемент и добавляем новый
                currentData.shift();
                
                // Рассчитываем новое значение на основе последнего значения
                let lastValue = currentData[currentData.length - 1];
                let change = (Math.random() - 0.5) * 16;
                let newValue = lastValue + change;
                newValue = Math.max(10, Math.min(90, newValue));
                
                currentData.push(newValue);
                
                // Обновляем данные в атрибуте
                chartContainer.dataset.chartData = JSON.stringify(currentData);
                
                // Перерисовываем график
                const stockChart = chartContainer.querySelector('.stock-chart');
                
                // Очищаем предыдущие элементы
                const candles = stockChart.querySelectorAll('.chart-candle, .chart-line, .chart-point');
                candles.forEach(candle => candle.remove());
                
                // Создаем новые элементы
                currentData.forEach((value, index) => {
                    // Свеча
                    const candle = document.createElement('div');
                    candle.className = 'chart-candle';
                    if (index > 0 && value < currentData[index - 1]) {
                        candle.classList.add('down');
                    }
                    
                    candle.style.height = `${value}%`;
                    candle.style.left = `${index * 5}%`;
                    stockChart.appendChild(candle);
                    
                    // Точка на линии
                    if (index < currentData.length - 1) {
                        const line = document.createElement('div');
                        line.className = 'chart-line';
                        line.style.height = '2px';
                        line.style.bottom = `${value}%`;
                        line.style.left = `${index * 5}%`;
                        line.style.width = '5%';
                        stockChart.appendChild(line);
                    }
                    
                    const point = document.createElement('div');
                    point.className = 'chart-point';
                    point.style.bottom = `${value}%`;
                    point.style.left = `${index * 5}%`;
                    stockChart.appendChild(point);
                });
                
                // Обновляем индикатор изменения
                const valueChange = stockChart.querySelector('.value-change');
                const lastTwoValues = currentData.slice(-2);
                const changePercent = ((lastTwoValues[1] - lastTwoValues[0]) / lastTwoValues[0] * 100).toFixed(2);
                
                valueChange.className = 'value-change';
                if (changePercent >= 0) {
                    valueChange.classList.add('up');
                    valueChange.textContent = `+${changePercent}%`;
                } else {
                    valueChange.classList.add('down');
                    valueChange.textContent = `${changePercent}%`;
                }
                
                // Обновляем основное значение с анимацией
                if (statValue) {
                    // Генерируем новое число на основе типа статистики
                    const statType = card.dataset.stat;
                    let newStatValue;
                    
                    switch (statType) {
                        case 'employment-rate':
                            newStatValue = (94 + Math.random() * 2).toFixed(1) + '%';
                            break;
                        case 'total-population':
                            newStatValue = (2.3 + Math.random() * 0.2).toFixed(1) + 'М';
                            break;
                        case 'labor-force':
                            newStatValue = Math.floor(4 + Math.random() * 2);
                            break;
                        case 'job-seekers':
                            newStatValue = Math.floor(9 + Math.random() * 3);
                            break;
                        default:
                            newStatValue = statValue.textContent;
                    }
                    
                    // Проверяем, изменилось ли значение
                    if (statValue.textContent !== newStatValue) {
                        statValue.classList.add('highlight-update');
                        statValue.textContent = newStatValue;
                        
                        // Удаляем класс анимации после завершения
                        setTimeout(() => {
                            statValue.classList.remove('highlight-update');
                        }, 1000);
                    }
                }
            });
        }
        
        // Функция для инициализации и анимации современных виджетов
        function initializeModernWidgets() {
            // Карта Таджикистана с регионами (упрощенная SVG-карта)
            const regionMap = document.querySelector('.region-map');
            if (regionMap) {
                regionMap.innerHTML = `
                <svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
                    <path id="region-dushanbe" d="M220,150 L240,150 L240,170 L220,170 Z" fill="#3b82f6" data-name="Душанбе" data-value="9,845" data-growth="+12.4%" />
                    <path id="region-sughd" d="M100,50 L250,50 L200,150 L100,130 Z" fill="#60a5fa" data-name="Согд" data-value="7,213" data-growth="+8.7%" />
                    <path id="region-khatlon" d="M150,180 L300,200 L280,250 L130,240 Z" fill="#93c5fd" data-name="Хатлон" data-value="5,421" data-growth="+3.2%" />
                    <path id="region-gbao" d="M300,100 L400,120 L380,250 L280,230 Z" fill="#bfdbfe" data-name="ГБАО" data-value="824" data-growth="-2.1%" />
                    <path id="region-rrp" d="M180,140 L260,120 L290,190 L180,180 Z" fill="#dbeafe" data-name="РРП" data-value="4,156" data-growth="+6.5%" />
                </svg>
                `;
                
                // Добавляем интерактивность к регионам
                const regions = regionMap.querySelectorAll('path');
                const regionHighlight = document.getElementById('selectedRegion');
                
                regions.forEach(region => {
                    region.addEventListener('mouseenter', function() {
                        // Сбрасываем цвета всех регионов
                        regions.forEach(r => r.style.opacity = '0.7');
                        
                        // Выделяем текущий регион
                        this.style.opacity = '1';
                        this.style.filter = 'drop-shadow(0 0 5px rgba(59, 130, 246, 0.5))';
                        
                        // Обновляем информацию о регионе
                        const name = this.getAttribute('data-name');
                        const value = this.getAttribute('data-value');
                        const growth = this.getAttribute('data-growth');
                        
                        regionHighlight.querySelector('.region-name').textContent = name;
                        regionHighlight.querySelector('.region-value').textContent = value;
                        regionHighlight.querySelector('.region-growth').textContent = growth + ' рост';
                        
                        // Анимируем появление информации
                        regionHighlight.style.animation = 'fadeInRight 0.3s forwards';
                    });
                    
                    region.addEventListener('mouseleave', function() {
                        this.style.filter = 'none';
                    });
                });
            }
            
            // Инициализация данных для топ-10 вакансий
            const vacanciesWrapper = document.querySelector('.vacancy-bars-wrapper');
            if (vacanciesWrapper) {
                // Очищаем контейнер
                vacanciesWrapper.innerHTML = '';
                
                // Данные о вакансиях
                const vacanciesData = [
                    { name: 'Разработчик ПО', count: 1248, growth: 14.5, barWidth: 90 },
                    { name: 'Специалист по маркетингу', count: 946, growth: 11.2, barWidth: 75 },
                    { name: 'Менеджер проектов', count: 834, growth: 9.8, barWidth: 70 },
                    { name: 'Бухгалтер', count: 782, growth: -2.3, barWidth: 65 },
                    { name: 'Инженер', count: 743, growth: 5.7, barWidth: 60 },
                    { name: 'Специалист по продажам', count: 678, growth: 8.1, barWidth: 55 },
                    { name: 'Администратор', count: 512, growth: 3.4, barWidth: 45 },
                    { name: 'HR-специалист', count: 489, growth: 7.5, barWidth: 42 },
                    { name: 'Врач', count: 437, growth: 15.2, barWidth: 40 },
                    { name: 'Учитель', count: 389, growth: -1.8, barWidth: 35 }
                ];
                
                // Создаем элементы для каждой вакансии
                vacanciesData.forEach((vacancy, index) => {
                    const vacancyItem = document.createElement('div');
                    vacancyItem.className = 'vacancy-item';
                    vacancyItem.style.animation = `fadeIn 0.3s ${index * 0.1}s both`;
                    
                    const rankDiv = document.createElement('div');
                    rankDiv.className = 'vacancy-rank';
                    rankDiv.textContent = index + 1;
                    
                    const nameDiv = document.createElement('div');
                    nameDiv.className = 'vacancy-name';
                    nameDiv.textContent = vacancy.name;
                    
                    const barDiv = document.createElement('div');
                    barDiv.className = 'vacancy-bar';
                    
                    const barFill = document.createElement('div');
                    barFill.className = 'bar-fill';
                    barFill.style.width = '0%';
                    
                    // Анимация заполнения полосы
                    setTimeout(() => {
                        barFill.style.width = `${vacancy.barWidth}%`;
                    }, 100 + index * 100);
                    
                    barDiv.appendChild(barFill);
                    
                    const countDiv = document.createElement('div');
                    countDiv.className = 'vacancy-count';
                    countDiv.textContent = vacancy.count.toLocaleString();
                    
                    const growthDiv = document.createElement('div');
                    growthDiv.className = `vacancy-growth ${vacancy.growth >= 0 ? 'positive' : 'negative'}`;
                    growthDiv.textContent = (vacancy.growth >= 0 ? '+' : '') + vacancy.growth + '%';
                    
                    // Собираем элемент
                    vacancyItem.appendChild(rankDiv);
                    vacancyItem.appendChild(nameDiv);
                    vacancyItem.appendChild(barDiv);
                    vacancyItem.appendChild(countDiv);
                    vacancyItem.appendChild(growthDiv);
                    
                    vacanciesWrapper.appendChild(vacancyItem);
                });
                
                // Добавляем интерактивность к сортировке
                const sortButtons = document.querySelectorAll('.sort-btn');
                sortButtons.forEach(btn => {
                    btn.addEventListener('click', function() {
                        sortButtons.forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        
                        const sortType = this.getAttribute('data-sort');
                        const sortedData = [...vacanciesData];
                        
                        if (sortType === 'count') {
                            sortedData.sort((a, b) => b.count - a.count);
                        } else if (sortType === 'growth') {
                            sortedData.sort((a, b) => b.growth - a.growth);
                        }
                        
                        // Обновляем UI
                        vacanciesWrapper.innerHTML = '';
                        sortedData.forEach((vacancy, index) => {
                            // Здесь такой же код создания элементов, как выше
                            const vacancyItem = document.createElement('div');
                            vacancyItem.className = 'vacancy-item';
                            vacancyItem.style.animation = `fadeIn 0.3s ${index * 0.05}s both`;
                            
                            // ... (остальной код для создания элементов)
                            const rankDiv = document.createElement('div');
                            rankDiv.className = 'vacancy-rank';
                            rankDiv.textContent = index + 1;
                            
                            const nameDiv = document.createElement('div');
                            nameDiv.className = 'vacancy-name';
                            nameDiv.textContent = vacancy.name;
                            
                            const barDiv = document.createElement('div');
                            barDiv.className = 'vacancy-bar';
                            
                            const barFill = document.createElement('div');
                            barFill.className = 'bar-fill';
                            barFill.style.width = '0%';
                            
                            // Анимация заполнения полосы
                            setTimeout(() => {
                                barFill.style.width = `${vacancy.barWidth}%`;
                            }, 100 + index * 50);
                            
                            barDiv.appendChild(barFill);
                            
                            const countDiv = document.createElement('div');
                            countDiv.className = 'vacancy-count';
                            countDiv.textContent = vacancy.count.toLocaleString();
                            
                            const growthDiv = document.createElement('div');
                            growthDiv.className = `vacancy-growth ${vacancy.growth >= 0 ? 'positive' : 'negative'}`;
                            growthDiv.textContent = (vacancy.growth >= 0 ? '+' : '') + vacancy.growth + '%';
                            
                            // Собираем элемент
                            vacancyItem.appendChild(rankDiv);
                            vacancyItem.appendChild(nameDiv);
                            vacancyItem.appendChild(barDiv);
                            vacancyItem.appendChild(countDiv);
                            vacancyItem.appendChild(growthDiv);
                            
                            vacanciesWrapper.appendChild(vacancyItem);
                        });
                    });
                });
            }
            
            // Кнопки периода для динамики занятости
            const periodButtons = document.querySelectorAll('.period-selector');
            periodButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    periodButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Эффект обновления графика при смене периода
                    const chartContainer = document.querySelector('.employment-3d-container');
                    if (chartContainer) {
                        const canvas = chartContainer.querySelector('canvas');
                        canvas.style.opacity = '0.5';
                        setTimeout(() => {
                            canvas.style.opacity = '1';
                        }, 300);
                        
                        // Обновление тултипа
                        const tooltip = chartContainer.querySelector('.chart-data-tooltip');
                        const highlight = chartContainer.querySelector('.chart-highlight');
                        
                        // Позиционируем подсветку случайным образом на графике
                        const randomX = 40 + Math.random() * 60; // 40-100%
                        const randomY = 30 + Math.random() * 40; // 30-70%
                        
                        highlight.style.left = `${randomX}%`;
                        highlight.style.top = `${randomY}%`;
                        highlight.style.opacity = '1';
                        
                        // Позиционируем тултип рядом с подсветкой
                        tooltip.style.left = `${randomX + 5}%`;
                        tooltip.style.top = `${randomY - 15}%`;
                        tooltip.style.opacity = '1';
                        tooltip.style.transform = 'translateY(0)';
                        
                        // Обновляем данные в тултипе в зависимости от периода
                        const period = this.getAttribute('data-period');
                        if (period === '6m') {
                            tooltip.querySelector('.date').textContent = 'Июнь 2025';
                            tooltip.querySelector('.value span').textContent = '95.2%';
                            tooltip.querySelector('.change').textContent = '+2.1% с прошлого месяца';
                        } else if (period === '1y') {
                            tooltip.querySelector('.date').textContent = 'Январь 2025';
                            tooltip.querySelector('.value span').textContent = '93.8%';
                            tooltip.querySelector('.change').textContent = '+3.5% с прошлого года';
                        } else {
                            tooltip.querySelector('.date').textContent = 'Июль 2023';
                            tooltip.querySelector('.value span').textContent = '91.4%';
                            tooltip.querySelector('.change').textContent = '+5.2% рост за 2 года';
                        }
                    }
                });
            });
            
            // Переключение метрик для региональной статистики
            const metricButtons = document.querySelectorAll('.stat-action-btn');
            metricButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    metricButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const metric = this.getAttribute('data-metric');
                    const regionHighlight = document.getElementById('selectedRegion');
                    
                    // Обновляем информацию о метрике
                    if (metric === 'employment') {
                        regionHighlight.querySelector('.region-label').textContent = 'уровень занятости';
                        regionHighlight.querySelector('.region-value').textContent = '93.4%';
                    } else if (metric === 'vacancies') {
                        regionHighlight.querySelector('.region-label').textContent = 'активных вакансий';
                        regionHighlight.querySelector('.region-value').textContent = '9,845';
                    }
                    
                    // Анимация обновления данных
                    regionHighlight.style.animation = 'scaleIn 0.3s forwards';
                    setTimeout(() => {
                        regionHighlight.style.animation = '';
                    }, 300);
                });
            });
            
            // Кольцевая диаграмма отраслей - обновление центрального значения при наведении
            const industryItems = document.querySelectorAll('.industry-item');
            const centerValue = document.querySelector('.center-value');
            const centerLabel = document.querySelector('.center-label');
            
            industryItems.forEach(item => {
                item.addEventListener('mouseenter', function() {
                    const name = this.querySelector('.name').textContent;
                    const value = this.querySelector('.value').textContent;
                    
                    // Анимация обновления данных в центре
                    centerValue.style.transform = 'translateY(-10px)';
                    centerValue.style.opacity = '0';
                    centerLabel.style.transform = 'translateY(-10px)';
                    centerLabel.style.opacity = '0';
                    
                    setTimeout(() => {
                        centerValue.textContent = value;
                        centerLabel.textContent = name;
                        
                        centerValue.style.transform = 'translateY(0)';
                        centerValue.style.opacity = '1';
                        centerLabel.style.transform = 'translateY(0)';
                        centerLabel.style.opacity = '1';
                    }, 200);
                    
                    // Подсвечиваем выбранный элемент
                    industryItems.forEach(i => i.style.backgroundColor = '');
                    this.style.backgroundColor = 'rgba(243, 244, 246, 0.7)';
                });
            });
            
            // Запускаем случайные обновления для демонстрации интерактивности
            setInterval(() => {
                // Случайные обновления подсветки на графике занятости
                const chartHighlight = document.querySelector('.chart-highlight');
                const chartTooltip = document.querySelector('.chart-data-tooltip');
                
                if (chartHighlight && chartTooltip) {
                    // С вероятностью 30% обновляем позицию
                    if (Math.random() < 0.3) {
                        // Генерируем новую случайную позицию
                        const randomX = 40 + Math.random() * 60;
                        const randomY = 30 + Math.random() * 40;
                        
                        // Анимируем перемещение подсветки
                        chartHighlight.style.transition = 'all 0.8s ease';
                        chartHighlight.style.left = `${randomX}%`;
                        chartHighlight.style.top = `${randomY}%`;
                        
                        // Анимируем перемещение тултипа
                        chartTooltip.style.transition = 'all 0.8s ease';
                        chartTooltip.style.left = `${randomX + 5}%`;
                        chartTooltip.style.top = `${randomY - 15}%`;
                        
                        // Генерируем новые данные для тултипа
                        const randomValue = (94 + Math.random() * 2).toFixed(1);
                        const randomChange = (Math.random() * 3).toFixed(1);
                        
                        // Обновляем данные в тултипе с небольшой задержкой
                        setTimeout(() => {
                            chartTooltip.querySelector('.value span').textContent = `${randomValue}%`;
                            chartTooltip.querySelector('.change').textContent = `+${randomChange}% с прошлого периода`;
                        }, 400);
                    }
                }
            }, 5000);
        }
        
        // Функция для инициализации всех графиков на странице
        function initializeAllCharts() {
            // Примерные данные для графиков
            const monthlyLabels = ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'];
            const colorPalette = ['#3b82f6', '#60a5fa', '#93c5fd', '#dbeafe', '#10b981', '#34d399', '#6ee7b7', '#a7f3d0', '#f59e0b', '#fbbf24', '#fcd34d', '#fef3c7'];
            
            // График динамики занятости
            const employmentTrendCtx = document.getElementById('employmentTrendChart');
            if (employmentTrendCtx) {
                const employmentGradient = employmentTrendCtx.getContext('2d').createLinearGradient(0, 0, 0, 300);
                employmentGradient.addColorStop(0, 'rgba(59, 130, 246, 0.8)');
                employmentGradient.addColorStop(1, 'rgba(59, 130, 246, 0.1)');
                
                new Chart(employmentTrendCtx, {
                    type: 'line',
                    data: {
                        labels: monthlyLabels,
                        datasets: [{
                            label: 'Уровень занятости',
                            data: [92.8, 93.1, 93.5, 94.2, 94.6, 95.1, 95.2, 95.0, 94.7, 94.3, 94.1, 94.5],
                            borderColor: '#3b82f6',
                            borderWidth: 3,
                            backgroundColor: employmentGradient,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#ffffff',
                            pointBorderColor: '#3b82f6',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            pointHoverBackgroundColor: '#3b82f6',
                            pointHoverBorderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 1500,
                            easing: 'easeOutQuart'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#6b7280',
                                bodyColor: '#111827',
                                bodyFont: {
                                    size: 14,
                                    weight: 700
                                },
                                padding: 15,
                                boxPadding: 8,
                                usePointStyle: true,
                                boxWidth: 8,
                                borderColor: 'rgba(0, 0, 0, 0.1)',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        return `Занятость: ${context.raw}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                suggestedMin: 90,
                                suggestedMax: 97,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            }
                        }
                    }
                });
            }
            
            // Распределение по отраслям - кольцевая диаграмма
            const industryDistributionCtx = document.getElementById('industryDistributionChart');
            if (industryDistributionCtx) {
                new Chart(industryDistributionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Услуги', 'Сельское хозяйство', 'Производство', 'Образование', 'Здравоохранение', 'Другие'],
                        datasets: [{
                            data: [45.8, 21.3, 18.5, 7.2, 3.5, 3.7],
                            backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#6b7280'],
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            hoverOffset: 15,
                            hoverBorderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '70%',
                        animation: {
                            animateRotate: true,
                            animateScale: true,
                            duration: 1500,
                            easing: 'easeOutCirc'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#6b7280',
                                bodyColor: '#111827',
                                bodyFont: {
                                    size: 14,
                                    weight: 700
                                },
                                padding: 15,
                                boxPadding: 8,
                                usePointStyle: true,
                                boxWidth: 8,
                                borderColor: 'rgba(0, 0, 0, 0.1)',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Региональная статистика - горизонтальная гистограмма
            const regionalStatsCtx = document.getElementById('regionalStatsChart');
            if (regionalStatsCtx) {
                const regions = ['Душанбе', 'Согд', 'Хатлон', 'РРП', 'ГБАО'];
                const vacancies = [9845, 7213, 5421, 4156, 824];
                
                const regionalGradient = regionalStatsCtx.getContext('2d').createLinearGradient(0, 0, 400, 0);
                regionalGradient.addColorStop(0, '#3b82f6');
                regionalGradient.addColorStop(1, '#60a5fa');
                
                new Chart(regionalStatsCtx, {
                    type: 'bar',
                    data: {
                        labels: regions,
                        datasets: [{
                            label: 'Активные вакансии',
                            data: vacancies,
                            backgroundColor: regionalGradient,
                            borderRadius: 10,
                            barThickness: 20,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 1500,
                            easing: 'easeOutQuart'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#6b7280',
                                bodyColor: '#111827',
                                bodyFont: {
                                    size: 14,
                                    weight: 700
                                },
                                padding: 15,
                                boxPadding: 8,
                                usePointStyle: true,
                                boxWidth: 8,
                                borderColor: 'rgba(0, 0, 0, 0.1)',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
            
            // Топ-10 вакансий - горизонтальная гистограмма
            const topVacanciesCtx = document.getElementById('topVacanciesChart');
            if (topVacanciesCtx) {
                const topVacancies = ['Разработчик ПО', 'Специалист по маркетингу', 'Менеджер проектов', 'Бухгалтер', 'Инженер', 'Специалист по продажам', 'Администратор', 'HR-специалист', 'Врач', 'Учитель'];
                const vacancyCounts = [1248, 946, 834, 782, 743, 678, 512, 489, 437, 389];
                
                const vacancyGradient = topVacanciesCtx.getContext('2d').createLinearGradient(0, 0, 400, 0);
                vacancyGradient.addColorStop(0, '#f59e0b');
                vacancyGradient.addColorStop(1, '#fbbf24');
                
                new Chart(topVacanciesCtx, {
                    type: 'bar',
                    data: {
                        labels: topVacancies,
                        datasets: [{
                            label: 'Количество вакансий',
                            data: vacancyCounts,
                            backgroundColor: vacancyGradient,
                            borderRadius: 10,
                            barThickness: 18,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            delay: function(context) {
                                return context.dataIndex * 100;
                            },
                            duration: 1000,
                            easing: 'easeOutQuart'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#6b7280',
                                bodyColor: '#111827',
                                bodyFont: {
                                    size: 14,
                                    weight: 700
                                },
                                padding: 15,
                                boxPadding: 8,
                                usePointStyle: true,
                                boxWidth: 8,
                                borderColor: 'rgba(0, 0, 0, 0.1)',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализируем биржевые графики
            initializeStockCharts();
            
            // Инициализируем современные виджеты
            initializeModernWidgets();
            
            // Инициализируем все графики на странице
            initializeAllCharts();
            
            // Запускаем интервал обновления каждые 3 секунды
            setInterval(updateStockCharts, 3000);
            
            // Остальной код инициализации
            const menuToggle = document.getElementById('menuToggle');
            const sideMenu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');
            const openFilters = document.getElementById('openFilters');
            const closeFilters = document.getElementById('closeFilters');
            const filterSidebar = document.getElementById('filterSidebar');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Открытие/закрытие бокового меню
            if (menuToggle && sideMenu && overlay) {
                menuToggle.addEventListener('click', function() {
                    sideMenu.classList.toggle('open');
                    overlay.classList.toggle('active');
                });
            }
            
            // Открытие/закрытие панели фильтров
            if (openFilters && closeFilters && filterSidebar && overlay) {
                openFilters.addEventListener('click', function() {
                    filterSidebar.classList.add('open');
                    overlay.classList.add('active');
                });
                
                closeFilters.addEventListener('click', function() {
                    filterSidebar.classList.remove('open');
                    overlay.classList.remove('active');
                });
            }
            
            // Закрытие всех панелей при клике на затемнение
            if (overlay && sideMenu && filterSidebar) {
                overlay.addEventListener('click', function() {
                    sideMenu.classList.remove('open');
                    filterSidebar.classList.remove('open');
                    overlay.classList.remove('active');
                });
            }
            
            // Переключение вкладок
            if (tabButtons && tabContents) {
                tabButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const tabId = this.getAttribute('data-tab');
                        
                        // Удаляем активный класс у всех кнопок и контента
                        tabButtons.forEach(btn => btn.classList.remove('active'));
                        tabContents.forEach(content => content.classList.remove('active'));
                        
                        // Добавляем активный класс выбранной вкладке
                        this.classList.add('active');
                        document.getElementById(tabId).classList.add('active');
                    });
                });
            }

            // Распределение по отраслям - интерактивное кольцо с 3D эффектами
            function initIndustryDistributionChart() {
                const ctx = document.getElementById('industryDistributionChart');
                if (!ctx) return;

                const data = {
                    labels: ['Услуги', 'Сельское хозяйство', 'Производство', 'Образование', 'Здравоохранение', 'Другое'],
                    datasets: [{
                        data: [45.8, 21.3, 18.5, 7.2, 4.5, 2.7],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(107, 114, 128, 0.8)'
                        ],
                        borderWidth: 1,
                        borderColor: 'rgba(255, 255, 255, 0.7)',
                        hoverBorderWidth: 3,
                        hoverBorderColor: '#ffffff',
                        cutout: '65%',
                        borderRadius: 6
                    }]
                };

                const industryChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutoutPercentage: 70,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                enabled: true,
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#111827',
                                bodyColor: '#111827',
                                borderColor: 'rgba(0, 0, 0, 0.1)',
                                borderWidth: 1,
                                cornerRadius: 8,
                                padding: 12,
                                boxPadding: 6,
                                usePointStyle: true,
                                callbacks: {
                                    label: function(context) {
                                        const value = context.raw;
                                        return `${context.label}: ${value}%`;
                                    },
                                    title: function(context) {
                                        return 'Отрасль';
                                    }
                                }
                            }
                        },
                        animation: {
                            animateRotate: true,
                            animateScale: true,
                            duration: 1000,
                            easing: 'easeOutQuart'
                        },
                        hover: {
                            mode: 'nearest',
                            intersect: false,
                            animationDuration: 200
                        }
                    }
                });

                // Анимация центрального индикатора при наведении на сегменты
                document.querySelectorAll('.industry-item').forEach((item, index) => {
                    item.addEventListener('mouseenter', () => {
                        const industry = item.getAttribute('data-industry');
                        const centerValue = document.querySelector('.center-value');
                        const centerLabel = document.querySelector('.center-label');
                        const centerChange = document.querySelector('.center-change-indicator');
                        
                        // Анимируем переход значения
                        animateValue(centerValue, parseFloat(centerValue.textContent), data.datasets[0].data[index], 500);
                        
                        // Изменяем текст и класс
                        centerLabel.textContent = data.labels[index];
                        
                        // Находим соответствующий тренд
                        const trendEl = item.querySelector('.trend');
                        if (trendEl.classList.contains('up')) {
                            centerChange.className = 'center-change-indicator up';
                            centerChange.innerHTML = '<i class="fas fa-arrow-up"></i> ' + (Math.random() * 5 + 1).toFixed(1) + '%';
                        } else if (trendEl.classList.contains('down')) {
                            centerChange.className = 'center-change-indicator down';
                            centerChange.innerHTML = '<i class="fas fa-arrow-down"></i> ' + (Math.random() * 3 + 0.5).toFixed(1) + '%';
                        } else {
                            centerChange.className = 'center-change-indicator stable';
                            centerChange.innerHTML = '<i class="fas fa-minus"></i> 0.0%';
                        }

                        // Подсветка активного сегмента
                        industryChart.setActiveElements([{datasetIndex: 0, index: index}]);
                        industryChart.update();
                    });
                });

                // Анимация обновления данных каждые 3 секунды
                setInterval(() => {
                    // Обновляем данные с небольшими случайными изменениями
                    data.datasets[0].data = data.datasets[0].data.map(value => {
                        const change = (Math.random() - 0.5) * 1.5; // Случайное изменение в диапазоне +/- 0.75%
                        return Math.max(0, Math.min(100, value + change));
                    });
                    
                    // Обновляем проценты в легенде
                    document.querySelectorAll('.industry-item .animated-value').forEach((el, index) => {
                        animateValue(el, parseFloat(el.textContent), data.datasets[0].data[index], 1000);
                    });
                    
                    industryChart.update();
                }, 3000);

                // Эффект 3D вращения при наведении на виджет
                const container = document.querySelector('.industry-ring-container');
                if (container) {
                    container.addEventListener('mousemove', (e) => {
                        const rect = container.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const centerY = rect.top + rect.height / 2;
                        const mouseX = e.clientX;
                        const mouseY = e.clientY;
                        
                        // Вычисляем угол наклона (не более 10 градусов)
                        const maxTilt = 10;
                        const tiltX = ((mouseY - centerY) / (rect.height / 2)) * maxTilt;
                        const tiltY = -((mouseX - centerX) / (rect.width / 2)) * maxTilt;
                        
                        // Применяем 3D трансформацию
                        ctx.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
                    });
                    
                    container.addEventListener('mouseleave', () => {
                        // Возвращаем в нормальное положение при уходе мыши
                        ctx.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
                    });
                }

                // Кнопки управления представлением
                document.querySelectorAll('.chart-control-btn[data-action="viewType"]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const viewType = this.getAttribute('data-view');
                        
                        // Переключаем активную кнопку
                        document.querySelectorAll('.chart-control-btn[data-action="viewType"]').forEach(b => {
                            b.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        // Изменяем тип графика
                        if (viewType === 'donut') {
                            industryChart.config.type = 'doughnut';
                        } else if (viewType === 'polar') {
                            industryChart.config.type = 'polarArea';
                        }
                        
                        industryChart.update();
                    });
                });
            }

            // Региональная статистика - интерактивная карта с анимацией
            function initRegionalStatistics() {
                // Анимация пульсирующих точек
                document.querySelectorAll('.pulsing-dot').forEach(dot => {
                    dot.addEventListener('mouseenter', () => {
                        // Подсвечиваем активную точку
                        document.querySelectorAll('.pulsing-dot').forEach(d => {
                            d.classList.remove('active');
                        });
                        dot.classList.add('active');
                        
                        // Обновляем данные в панели выбранного региона
                        const regionName = dot.getAttribute('data-region');
                        const regionValue = dot.getAttribute('data-value');
                        const regionHighlight = document.getElementById('selectedRegion');
                        
                        if (regionHighlight) {
                            const nameEl = regionHighlight.querySelector('.region-name');
                            const valueEl = regionHighlight.querySelector('.region-value');
                            
                            if (nameEl && valueEl) {
                                // Преобразуем название региона
                                let displayName = 'Регион';
                                switch(regionName) {
                                    case 'dushanbe': displayName = 'Душанбе'; break;
                                    case 'sughd': displayName = 'Согд'; break;
                                    case 'khatlon': displayName = 'Хатлон'; break;
                                    case 'gbao': displayName = 'ГБАО'; break;
                                }
                                
                                nameEl.textContent = displayName;
                                animateValue(valueEl, parseInt(valueEl.textContent.replace(/,/g, '')), parseInt(regionValue), 800);
                            }
                        }
                        
                        // Обновляем детальную панель региона
                        const detailPanel = document.querySelector('.region-detail-panel');
                        const detailHeader = detailPanel.querySelector('.region-name');
                        const detailValues = detailPanel.querySelectorAll('.animated-value');
                        
                        if (detailHeader) {
                            // Преобразуем название региона
                            let displayName = 'Регион';
                            switch(regionName) {
                                case 'dushanbe': displayName = 'Душанбе'; break;
                                case 'sughd': displayName = 'Согд'; break;
                                case 'khatlon': displayName = 'Хатлон'; break;
                                case 'gbao': displayName = 'ГБАО'; break;
                            }
                            
                            detailHeader.textContent = displayName;
                        }
                        
                        if (detailValues.length > 0) {
                            // Устанавливаем значения с анимацией
                            animateValue(detailValues[0], parseInt(detailValues[0].textContent.replace(/,/g, '')), parseInt(regionValue), 800);
                            
                            // Безработица зависит от региона
                            let unemploymentRate = 0;
                            switch(regionName) {
                                case 'dushanbe': unemploymentRate = 2.8; break;
                                case 'sughd': unemploymentRate = 3.5; break;
                                case 'khatlon': unemploymentRate = 4.2; break;
                                case 'gbao': unemploymentRate = 5.1; break;
                                default: unemploymentRate = 3.8;
                            }
                            
                            animateValue(detailValues[1], parseFloat(detailValues[1].textContent), unemploymentRate, 800);
                            
                            // Средняя зарплата зависит от региона
                            let avgSalary = 0;
                            switch(regionName) {
                                case 'dushanbe': avgSalary = 4250; break;
                                case 'sughd': avgSalary = 3650; break;
                                case 'khatlon': avgSalary = 2950; break;
                                case 'gbao': avgSalary = 3150; break;
                                default: avgSalary = 3500;
                            }
                            
                            animateValue(detailValues[2], parseInt(detailValues[2].textContent.replace(/,/g, '')), avgSalary, 800);
                        }
                    });
                });
                
                // Переключение фильтров
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        // Переключаем активную кнопку
                        document.querySelectorAll('.filter-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        const filterType = this.getAttribute('data-filter');
                        const pulseDots = document.querySelectorAll('.pulsing-dot');
                        const regionLabel = document.querySelector('.region-label');
                        
                        // Обновляем метрику
                        if (regionLabel) {
                            switch(filterType) {
                                case 'vacancies': 
                                    regionLabel.textContent = 'активных вакансий';
                                    // Обновляем значения на точках для вакансий
                                    pulseDots.forEach(dot => {
                                        const region = dot.getAttribute('data-region');
                                        let value = 0;
                                        switch(region) {
                                            case 'dushanbe': value = 9845; break;
                                            case 'sughd': value = 6254; break;
                                            case 'khatlon': value = 4875; break;
                                            case 'gbao': value = 2325; break;
                                            default: value = 1000;
                                        }
                                        dot.setAttribute('data-value', value);
                                        
                                        // Если это активная точка, обновляем показатели
                                        if (dot.classList.contains('active')) {
                                            dot.dispatchEvent(new Event('mouseenter'));
                                        }
                                    });
                                    break;
                                case 'unemployment': 
                                    regionLabel.textContent = 'уровень безработицы';
                                    // Обновляем значения на точках для безработицы
                                    pulseDots.forEach(dot => {
                                        const region = dot.getAttribute('data-region');
                                        let value = 0;
                                        switch(region) {
                                            case 'dushanbe': value = 2.8; break;
                                            case 'sughd': value = 3.5; break;
                                            case 'khatlon': value = 4.2; break;
                                            case 'gbao': value = 5.1; break;
                                            default: value = 3.8;
                                        }
                                        dot.setAttribute('data-value', value);
                                        
                                        // Если это активная точка, обновляем показатели
                                        if (dot.classList.contains('active')) {
                                            dot.dispatchEvent(new Event('mouseenter'));
                                        }
                                    });
                                    break;
                                case 'salary': 
                                    regionLabel.textContent = 'средняя зарплата (сомони)';
                                    // Обновляем значения на точках для зарплаты
                                    pulseDots.forEach(dot => {
                                        const region = dot.getAttribute('data-region');
                                        let value = 0;
                                        switch(region) {
                                            case 'dushanbe': value = 4250; break;
                                            case 'sughd': value = 3650; break;
                                            case 'khatlon': value = 2950; break;
                                            case 'gbao': value = 3150; break;
                                            default: value = 3500;
                                        }
                                        dot.setAttribute('data-value', value);
                                        
                                        // Если это активная точка, обновляем показатели
                                        if (dot.classList.contains('active')) {
                                            dot.dispatchEvent(new Event('mouseenter'));
                                        }
                                    });
                                    break;
                            }
                        }
                    });
                });
            }

            // Вспомогательная функция для анимации изменения числовых значений
            function animateValue(element, start, end, duration) {
                if (!element) return;
                
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const value = progress * (end - start) + start;
                    
                    // Форматируем число в зависимости от его типа
                    if (Number.isInteger(end)) {
                        element.textContent = Math.floor(value).toLocaleString();
                    } else {
                        element.textContent = value.toFixed(1);
                    }
                    
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }

            // Инициализация новых виджетов
            document.addEventListener('DOMContentLoaded', function() {
                // Инициализируем все виджеты
                initIndustryDistributionChart();
                initRegionalStatistics();
                
                // Обработка кликов на элементы легенды отраслей
                document.querySelectorAll('.industry-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const industry = this.getAttribute('data-industry');
                        const detailsPanel = document.querySelector('.industry-details');
                        const detailName = detailsPanel.querySelector('.industry-detail-name');
                        
                        // Показываем панель деталей
                        detailsPanel.classList.toggle('collapse');
                        
                        // Устанавливаем название отрасли
                        if (detailName) {
                            switch(industry) {
                                case 'services': detailName.textContent = 'Услуги'; break;
                                case 'agriculture': detailName.textContent = 'Сельское хозяйство'; break;
                                case 'production': detailName.textContent = 'Производство'; break;
                                default: detailName.textContent = 'Отрасль';
                            }
                        }
                    });
                });
                
                // Закрытие панели деталей отрасли
                document.querySelector('.close-details')?.addEventListener('click', function() {
                    document.querySelector('.industry-details').classList.add('collapse');
                });
            });
        });
    </script>
</body>
</html>
