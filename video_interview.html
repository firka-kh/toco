<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Видеоинтервью - Портал Рынка Труда</title>
    <meta name="description" content="Проводите видеоинтервью онлайн. Современная платформа для удобного общения работодателей и кандидатов.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <section class="page-header">
            <div class="container">
                <div class="page-header-content">
                    <div class="breadcrumb">
                        <a href="index.html">Главная</a>
                        <i class="fas fa-chevron-right"></i>
                        <a href="employer_dashboard.html">Для работодателей</a>
                        <i class="fas fa-chevron-right"></i>
                        <span>Видеоинтервью</span>
                    </div>
                    <h1 class="page-title">
                        <i class="fas fa-video"></i>
                        Видеоинтервью
                    </h1>
                    <p class="page-subtitle">Современная платформа для проведения онлайн-собеседований</p>
                </div>
                <div class="page-actions">
                    <button class="btn btn-primary" id="schedule-interview">
                        <i class="fas fa-calendar-plus"></i>
                        Запланировать интервью
                    </button>
                    <button class="btn btn-outline" id="join-interview">
                        <i class="fas fa-video"></i>
                        Присоединиться к интервью
                    </button>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-overview">
            <div class="container">
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-hd-video"></i>
                        </div>
                        <h3>HD видео</h3>
                        <p>Качественное видео и аудио для комфортного общения</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-share-square"></i>
                        </div>
                        <h3>Демонстрация экрана</h3>
                        <p>Возможность показать презентацию или выполнить тестовое задание</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-record-vinyl"></i>
                        </div>
                        <h3>Запись интервью</h3>
                        <p>Автоматическая запись для последующего просмотра и оценки</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>Чат в реальном времени</h3>
                        <p>Текстовые сообщения и обмен файлами во время интервью</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interview Management -->
        <section class="interview-management">
            <div class="container">
                <div class="management-tabs">
                    <button class="tab-btn active" data-tab="upcoming">
                        <i class="fas fa-clock"></i>
                        Предстоящие (3)
                    </button>
                    <button class="tab-btn" data-tab="completed">
                        <i class="fas fa-check-circle"></i>
                        Завершенные (12)
                    </button>
                    <button class="tab-btn" data-tab="scheduled">
                        <i class="fas fa-calendar-alt"></i>
                        Запланированные (7)
                    </button>
                </div>

                <!-- Upcoming Interviews -->
                <div class="tab-content active" data-tab="upcoming">
                    <div class="interviews-list">
                        <div class="interview-card upcoming">
                            <div class="interview-header">
                                <div class="interview-info">
                                    <h4>Frontend разработчик - Алишер Рахимов</h4>
                                    <div class="interview-meta">
                                        <span><i class="fas fa-building"></i> TajSoft</span>
                                        <span><i class="fas fa-calendar"></i> Сегодня, 15:00</span>
                                        <span><i class="fas fa-clock"></i> 45 минут</span>
                                    </div>
                                </div>
                                <div class="interview-status">
                                    <span class="status-badge pending">Ожидает</span>
                                    <div class="countdown" data-time="2024-01-15T15:00:00">
                                        <span class="countdown-time">02:30:15</span>
                                    </div>
                                </div>
                            </div>
                            <div class="interview-details">
                                <div class="candidate-info">
                                    <img src="https://via.placeholder.com/60x60" alt="Алишер Рахимов">
                                    <div>
                                        <h5>Алишер Рахимов</h5>
                                        <p>5 лет опыта в frontend разработке</p>
                                        <div class="candidate-skills">
                                            <span class="skill-tag">React</span>
                                            <span class="skill-tag">TypeScript</span>
                                            <span class="skill-tag">Vue.js</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-actions">
                                    <button class="btn btn-outline btn-sm" onclick="viewResume(1)">
                                        <i class="fas fa-file-alt"></i>
                                        Резюме
                                    </button>
                                    <button class="btn btn-outline btn-sm" onclick="prepareQuestions(1)">
                                        <i class="fas fa-list"></i>
                                        Вопросы
                                    </button>
                                    <button class="btn btn-primary btn-sm" onclick="startInterview(1)">
                                        <i class="fas fa-video"></i>
                                        Начать интервью
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="interview-card upcoming">
                            <div class="interview-header">
                                <div class="interview-info">
                                    <h4>UX/UI Дизайнер - Нилуфар Сафарова</h4>
                                    <div class="interview-meta">
                                        <span><i class="fas fa-building"></i> DushanbeTech</span>
                                        <span><i class="fas fa-calendar"></i> Завтра, 10:30</span>
                                        <span><i class="fas fa-clock"></i> 60 минут</span>
                                    </div>
                                </div>
                                <div class="interview-status">
                                    <span class="status-badge confirmed">Подтверждено</span>
                                </div>
                            </div>
                            <div class="interview-details">
                                <div class="candidate-info">
                                    <img src="https://via.placeholder.com/60x60" alt="Нилуфар Сафарова">
                                    <div>
                                        <h5>Нилуфар Сафарова</h5>
                                        <p>3 года опыта в UX/UI дизайне</p>
                                        <div class="candidate-skills">
                                            <span class="skill-tag">Figma</span>
                                            <span class="skill-tag">Sketch</span>
                                            <span class="skill-tag">Adobe XD</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-actions">
                                    <button class="btn btn-outline btn-sm" onclick="viewResume(2)">
                                        <i class="fas fa-file-alt"></i>
                                        Резюме
                                    </button>
                                    <button class="btn btn-outline btn-sm" onclick="prepareQuestions(2)">
                                        <i class="fas fa-list"></i>
                                        Вопросы
                                    </button>
                                    <button class="btn btn-outline btn-sm" onclick="rescheduleInterview(2)">
                                        <i class="fas fa-calendar-alt"></i>
                                        Перенести
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="interview-card upcoming">
                            <div class="interview-header">
                                <div class="interview-info">
                                    <h4>Менеджер по продажам - Рустам Холов</h4>
                                    <div class="interview-meta">
                                        <span><i class="fas fa-building"></i> LogisTaj</span>
                                        <span><i class="fas fa-calendar"></i> 18 января, 14:00</span>
                                        <span><i class="fas fa-clock"></i> 30 минут</span>
                                    </div>
                                </div>
                                <div class="interview-status">
                                    <span class="status-badge pending">Ожидает подтверждения</span>
                                </div>
                            </div>
                            <div class="interview-details">
                                <div class="candidate-info">
                                    <img src="https://via.placeholder.com/60x60" alt="Рустам Холов">
                                    <div>
                                        <h5>Рустам Холов</h5>
                                        <p>2 года опыта в продажах</p>
                                        <div class="candidate-skills">
                                            <span class="skill-tag">CRM</span>
                                            <span class="skill-tag">Переговоры</span>
                                            <span class="skill-tag">B2B продажи</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-actions">
                                    <button class="btn btn-outline btn-sm" onclick="viewResume(3)">
                                        <i class="fas fa-file-alt"></i>
                                        Резюме
                                    </button>
                                    <button class="btn btn-success btn-sm" onclick="confirmInterview(3)">
                                        <i class="fas fa-check"></i>
                                        Подтвердить
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="cancelInterview(3)">
                                        <i class="fas fa-times"></i>
                                        Отменить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Completed Interviews -->
                <div class="tab-content" data-tab="completed">
                    <div class="interviews-list">
                        <div class="interview-card completed">
                            <div class="interview-header">
                                <div class="interview-info">
                                    <h4>Backend разработчик - Джамшед Юсупов</h4>
                                    <div class="interview-meta">
                                        <span><i class="fas fa-building"></i> TechSolutions</span>
                                        <span><i class="fas fa-calendar"></i> 10 января, 16:00</span>
                                        <span><i class="fas fa-clock"></i> 50 минут</span>
                                    </div>
                                </div>
                                <div class="interview-rating">
                                    <div class="rating-stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                    </div>
                                    <span class="rating-text">4.0/5</span>
                                </div>
                            </div>
                            <div class="interview-details">
                                <div class="interview-summary">
                                    <p><strong>Результат:</strong> Кандидат рекомендован для следующего этапа</p>
                                    <p><strong>Заметки:</strong> Отличные технические навыки, хорошая коммуникация</p>
                                </div>
                                <div class="interview-actions">
                                    <button class="btn btn-outline btn-sm" onclick="viewRecording(1)">
                                        <i class="fas fa-play"></i>
                                        Запись
                                    </button>
                                    <button class="btn btn-outline btn-sm" onclick="viewFeedback(1)">
                                        <i class="fas fa-comment"></i>
                                        Отзыв
                                    </button>
                                    <button class="btn btn-primary btn-sm" onclick="scheduleNextRound(1)">
                                        <i class="fas fa-arrow-right"></i>
                                        Следующий этап
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scheduled Interviews -->
                <div class="tab-content" data-tab="scheduled">
                    <div class="calendar-view">
                        <div class="calendar-header">
                            <button class="calendar-nav" id="prev-week">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h3 id="calendar-title">15 - 21 января 2025</h3>
                            <button class="calendar-nav" id="next-week">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- Calendar will be generated here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Video Interface -->
        <section class="video-interface" id="video-interface" style="display: none;">
            <div class="video-container">
                <div class="video-grid">
                    <div class="video-main">
                        <video id="remote-video" autoplay playsinline></video>
                        <div class="video-overlay">
                            <div class="participant-name">Алишер Рахимов</div>
                            <div class="video-status">
                                <span class="status-indicator online"></span>
                                Подключен
                            </div>
                        </div>
                    </div>
                    <div class="video-local">
                        <video id="local-video" autoplay playsinline muted></video>
                        <div class="video-overlay">
                            <div class="participant-name">Вы</div>
                        </div>
                    </div>
                </div>

                <div class="video-controls">
                    <div class="control-group">
                        <button class="control-btn" id="toggle-audio" title="Микрофон">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="control-btn" id="toggle-video" title="Камера">
                            <i class="fas fa-video"></i>
                        </button>
                        <button class="control-btn" id="share-screen" title="Демонстрация экрана">
                            <i class="fas fa-desktop"></i>
                        </button>
                    </div>
                    
                    <div class="timer-display" id="interview-timer">
                        00:00:00
                    </div>
                    
                    <div class="control-group">
                        <button class="control-btn" id="toggle-chat" title="Чат">
                            <i class="fas fa-comments"></i>
                        </button>
                        <button class="control-btn" id="toggle-recording" title="Запись">
                            <i class="fas fa-record-vinyl"></i>
                        </button>
                        <button class="control-btn danger" id="end-call" title="Завершить">
                            <i class="fas fa-phone-slash"></i>
                        </button>
                    </div>
                </div>

                <div class="side-panel" id="side-panel">
                    <div class="panel-tabs">
                        <button class="panel-tab active" data-panel="chat">
                            <i class="fas fa-comments"></i>
                            Чат
                        </button>
                        <button class="panel-tab" data-panel="notes">
                            <i class="fas fa-sticky-note"></i>
                            Заметки
                        </button>
                        <button class="panel-tab" data-panel="questions">
                            <i class="fas fa-list"></i>
                            Вопросы
                        </button>
                    </div>

                    <div class="panel-content active" data-panel="chat">
                        <div class="chat-messages" id="chat-messages">
                            <div class="chat-message system">
                                <span>Интервью началось</span>
                                <time>15:00</time>
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" placeholder="Введите сообщение..." id="chat-input">
                            <button id="send-message">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>

                    <div class="panel-content" data-panel="notes">
                        <textarea placeholder="Ваши заметки о кандидате..." id="interview-notes"></textarea>
                        <button class="btn btn-primary btn-sm" id="save-notes">
                            <i class="fas fa-save"></i>
                            Сохранить заметки
                        </button>
                    </div>

                    <div class="panel-content" data-panel="questions">
                        <div class="questions-list">
                            <div class="question-item">
                                <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="checkmark"></span>
                                    Расскажите о своем опыте работы с React
                                </label>
                            </div>
                            <div class="question-item">
                                <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="checkmark"></span>
                                    Как вы подходите к оптимизации производительности?
                                </label>
                            </div>
                            <div class="question-item">
                                <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="checkmark"></span>
                                    Опишите ваш опыт работы в команде
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Schedule Interview Modal -->
    <div class="modal" id="schedule-modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Запланировать видеоинтервью</h3>
                <button class="modal-close" id="schedule-modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form class="schedule-form" id="schedule-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="candidate-email">Email кандидата *</label>
                            <input type="email" id="candidate-email" required placeholder="candidate@email.com">
                        </div>
                        <div class="form-group">
                            <label for="position">Позиция *</label>
                            <input type="text" id="position" required placeholder="Frontend разработчик">
                        </div>
                        <div class="form-group">
                            <label for="interview-date">Дата *</label>
                            <input type="date" id="interview-date" required>
                        </div>
                        <div class="form-group">
                            <label for="interview-time">Время *</label>
                            <input type="time" id="interview-time" required>
                        </div>
                        <div class="form-group">
                            <label for="duration">Длительность</label>
                            <select id="duration">
                                <option value="30">30 минут</option>
                                <option value="45" selected>45 минут</option>
                                <option value="60">1 час</option>
                                <option value="90">1.5 часа</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="timezone">Часовой пояс</label>
                            <select id="timezone">
                                <option value="Asia/Dushanbe">Душанбе (UTC+5)</option>
                                <option value="Asia/Tashkent">Ташкент (UTC+5)</option>
                                <option value="Europe/Moscow">Москва (UTC+3)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="interview-description">Описание интервью</label>
                        <textarea id="interview-description" rows="3" 
                                  placeholder="Опишите цель интервью, что нужно подготовить кандидату..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Дополнительные опции</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="options" value="recording" checked>
                                <span class="checkmark"></span>
                                Записывать интервью
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="options" value="calendar">
                                <span class="checkmark"></span>
                                Добавить в календарь
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="options" value="reminder">
                                <span class="checkmark"></span>
                                Напоминание за час до интервью
                            </label>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline">
                            <i class="fas fa-save"></i>
                            Сохранить как шаблон
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-calendar-plus"></i>
                            Запланировать интервью
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Join Interview Modal -->
    <div class="modal" id="join-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Присоединиться к интервью</h3>
                <button class="modal-close" id="join-modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form class="join-form" id="join-form">
                    <div class="form-group">
                        <label for="interview-id">ID интервью</label>
                        <input type="text" id="interview-id" placeholder="Введите ID интервью" required>
                        <div class="form-hint">ID интервью можно найти в приглашении или календаре</div>
                    </div>
                    <div class="form-group">
                        <label for="participant-name">Ваше имя</label>
                        <input type="text" id="participant-name" placeholder="Введите ваше имя" required>
                    </div>
                    <div class="device-check">
                        <h4>Проверка устройств</h4>
                        <div class="device-preview">
                            <video id="preview-video" autoplay muted></video>
                        </div>
                        <div class="device-controls">
                            <button type="button" class="btn btn-outline btn-sm" id="test-camera">
                                <i class="fas fa-video"></i>
                                Проверить камеру
                            </button>
                            <button type="button" class="btn btn-outline btn-sm" id="test-microphone">
                                <i class="fas fa-microphone"></i>
                                Проверить микрофон
                            </button>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-video"></i>
                            Присоединиться к интервью
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <script src="script.js"></script>
    <script>
        let interviewTimer;
        let timerSeconds = 0;
        let isRecording = false;
        let isChatOpen = false;

        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            initializeCalendar();
            startCountdowns();
        });

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });

            // Modal handlers
            document.getElementById('schedule-interview').addEventListener('click', function() {
                document.getElementById('schedule-modal').classList.add('show');
                document.body.style.overflow = 'hidden';
            });

            document.getElementById('join-interview').addEventListener('click', function() {
                document.getElementById('join-modal').classList.add('show');
                document.body.style.overflow = 'hidden';
            });

            // Modal close handlers
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('show');
                    document.body.style.overflow = '';
                });
            });

            // Form submissions
            document.getElementById('schedule-form').addEventListener('submit', scheduleInterview);
            document.getElementById('join-form').addEventListener('submit', joinInterview);

            // Video controls
            document.getElementById('toggle-audio').addEventListener('click', toggleAudio);
            document.getElementById('toggle-video').addEventListener('click', toggleVideo);
            document.getElementById('share-screen').addEventListener('click', shareScreen);
            document.getElementById('toggle-chat').addEventListener('click', toggleChat);
            document.getElementById('toggle-recording').addEventListener('click', toggleRecording);
            document.getElementById('end-call').addEventListener('click', endCall);

            // Chat functionality
            document.getElementById('send-message').addEventListener('click', sendMessage);
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Panel tabs
            document.querySelectorAll('.panel-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchPanel(this.dataset.panel);
                });
            });

            // Save notes
            document.getElementById('save-notes').addEventListener('click', saveNotes);

            // Device testing
            document.getElementById('test-camera').addEventListener('click', testCamera);
            document.getElementById('test-microphone').addEventListener('click', testMicrophone);
        }

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.dataset.tab === tabName);
            });
        }

        function switchPanel(panelName) {
            // Update panel tabs
            document.querySelectorAll('.panel-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.panel === panelName);
            });

            // Update panel content
            document.querySelectorAll('.panel-content').forEach(content => {
                content.classList.toggle('active', content.dataset.panel === panelName);
            });
        }

        function initializeCalendar() {
            const calendarGrid = document.getElementById('calendar-grid');
            const days = ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'];
            const hours = Array.from({length: 12}, (_, i) => i + 8); // 8:00 - 19:00

            // Create header
            let headerHTML = '<div class="calendar-time-column"></div>';
            days.forEach(day => {
                headerHTML += `<div class="calendar-day-header">${day}</div>`;
            });
            
            // Create time slots
            let slotsHTML = '';
            hours.forEach(hour => {
                slotsHTML += `<div class="calendar-time-slot">${hour}:00</div>`;
                days.forEach((day, dayIndex) => {
                    const hasInterview = Math.random() > 0.8; // Random interviews for demo
                    const slotClass = hasInterview ? 'calendar-slot busy' : 'calendar-slot';
                    const interviewTitle = hasInterview ? 'Frontend разработчик' : '';
                    slotsHTML += `<div class="${slotClass}" data-day="${dayIndex}" data-hour="${hour}">
                        ${interviewTitle ? `<div class="interview-slot">${interviewTitle}</div>` : ''}
                    </div>`;
                });
            });

            calendarGrid.innerHTML = headerHTML + slotsHTML;
        }

        function startCountdowns() {
            document.querySelectorAll('.countdown').forEach(countdown => {
                const targetTime = new Date(countdown.dataset.time);
                
                setInterval(() => {
                    const now = new Date();
                    const diff = targetTime - now;
                    
                    if (diff > 0) {
                        const hours = Math.floor(diff / (1000 * 60 * 60));
                        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                        
                        countdown.querySelector('.countdown-time').textContent = 
                            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    } else {
                        countdown.querySelector('.countdown-time').textContent = 'Интервью началось';
                        countdown.style.color = '#e74c3c';
                    }
                }, 1000);
            });
        }

        function scheduleInterview(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const interviewData = {
                candidateEmail: formData.get('candidate-email'),
                position: formData.get('position'),
                date: formData.get('interview-date'),
                time: formData.get('interview-time'),
                duration: formData.get('duration')
            };

            // Simulate scheduling
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Планирование...';

            setTimeout(() => {
                PortalUtils.showNotification('Интервью успешно запланировано! Приглашение отправлено кандидату.', 'success');
                document.getElementById('schedule-modal').classList.remove('show');
                document.body.style.overflow = '';
                e.target.reset();
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-calendar-plus"></i> Запланировать интервью';
            }, 2000);
        }

        function joinInterview(e) {
            e.preventDefault();
            
            const interviewId = document.getElementById('interview-id').value;
            const participantName = document.getElementById('participant-name').value;

            if (!interviewId || !participantName) {
                PortalUtils.showNotification('Заполните все обязательные поля', 'error');
                return;
            }

            // Close modal and start interview
            document.getElementById('join-modal').classList.remove('show');
            document.body.style.overflow = '';
            
            startInterview();
        }

        function startInterview(interviewId = null) {
            // Hide main content and show video interface
            document.querySelector('.interview-management').style.display = 'none';
            document.getElementById('video-interface').style.display = 'block';
            
            // Start timer
            startInterviewTimer();
            
            // Initialize mock video streams
            initializeMockVideo();
            
            PortalUtils.showNotification('Интервью началось. Запись включена.', 'info');
        }

        function startInterviewTimer() {
            timerSeconds = 0;
            interviewTimer = setInterval(() => {
                timerSeconds++;
                const hours = Math.floor(timerSeconds / 3600);
                const minutes = Math.floor((timerSeconds % 3600) / 60);
                const seconds = timerSeconds % 60;
                
                document.getElementById('interview-timer').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function initializeMockVideo() {
            // Mock video initialization
            const localVideo = document.getElementById('local-video');
            const remoteVideo = document.getElementById('remote-video');
            
            // Create colored rectangles as placeholders
            localVideo.style.background = 'linear-gradient(45deg, #0078D4, #4FC3F7)';
            remoteVideo.style.background = 'linear-gradient(45deg, #2ECC71, #27AE60)';
        }

        function toggleAudio() {
            const btn = document.getElementById('toggle-audio');
            const icon = btn.querySelector('i');
            
            btn.classList.toggle('muted');
            if (btn.classList.contains('muted')) {
                icon.className = 'fas fa-microphone-slash';
                btn.title = 'Включить микрофон';
                PortalUtils.showNotification('Микрофон выключен', 'info');
            } else {
                icon.className = 'fas fa-microphone';
                btn.title = 'Выключить микрофон';
                PortalUtils.showNotification('Микрофон включен', 'info');
            }
        }

        function toggleVideo() {
            const btn = document.getElementById('toggle-video');
            const icon = btn.querySelector('i');
            const localVideo = document.getElementById('local-video');
            
            btn.classList.toggle('disabled');
            if (btn.classList.contains('disabled')) {
                icon.className = 'fas fa-video-slash';
                btn.title = 'Включить камеру';
                localVideo.style.background = '#2c3e50';
                PortalUtils.showNotification('Камера выключена', 'info');
            } else {
                icon.className = 'fas fa-video';
                btn.title = 'Выключить камеру';
                localVideo.style.background = 'linear-gradient(45deg, #0078D4, #4FC3F7)';
                PortalUtils.showNotification('Камера включена', 'info');
            }
        }

        function shareScreen() {
            const btn = document.getElementById('share-screen');
            btn.classList.toggle('active');
            
            if (btn.classList.contains('active')) {
                btn.title = 'Остановить демонстрацию';
                PortalUtils.showNotification('Демонстрация экрана началась', 'info');
            } else {
                btn.title = 'Демонстрация экрана';
                PortalUtils.showNotification('Демонстрация экрана остановлена', 'info');
            }
        }

        function toggleChat() {
            const sidePanel = document.getElementById('side-panel');
            isChatOpen = !isChatOpen;
            
            sidePanel.style.display = isChatOpen ? 'block' : 'none';
            
            if (isChatOpen) {
                switchPanel('chat');
            }
        }

        function toggleRecording() {
            const btn = document.getElementById('toggle-recording');
            const icon = btn.querySelector('i');
            
            isRecording = !isRecording;
            btn.classList.toggle('recording', isRecording);
            
            if (isRecording) {
                icon.className = 'fas fa-stop';
                btn.title = 'Остановить запись';
                PortalUtils.showNotification('Запись началась', 'success');
            } else {
                icon.className = 'fas fa-record-vinyl';
                btn.title = 'Начать запись';
                PortalUtils.showNotification('Запись остановлена', 'info');
            }
        }

        function endCall() {
            if (confirm('Вы уверены, что хотите завершить интервью?')) {
                // Stop timer
                clearInterval(interviewTimer);
                
                // Show main content
                document.querySelector('.interview-management').style.display = 'block';
                document.getElementById('video-interface').style.display = 'none';
                
                PortalUtils.showNotification('Интервью завершено. Запись сохранена.', 'success');
            }
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message) {
                const chatMessages = document.getElementById('chat-messages');
                const messageEl = document.createElement('div');
                messageEl.className = 'chat-message sent';
                messageEl.innerHTML = `
                    <span>${message}</span>
                    <time>${new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}</time>
                `;
                
                chatMessages.appendChild(messageEl);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                input.value = '';
            }
        }

        function saveNotes() {
            const notes = document.getElementById('interview-notes').value;
            if (notes.trim()) {
                PortalUtils.showNotification('Заметки сохранены', 'success');
            }
        }

        function testCamera() {
            const previewVideo = document.getElementById('preview-video');
            previewVideo.style.background = 'linear-gradient(45deg, #0078D4, #4FC3F7)';
            PortalUtils.showNotification('Камера работает корректно', 'success');
        }

        function testMicrophone() {
            PortalUtils.showNotification('Микрофон работает корректно', 'success');
        }

        // Global functions for interview actions
        window.viewResume = function(candidateId) {
            PortalUtils.showNotification('Резюме кандидата будет открыто в новой вкладке', 'info');
        };

        window.prepareQuestions = function(candidateId) {
            switchPanel('questions');
            if (!isChatOpen) toggleChat();
        };

        window.confirmInterview = function(candidateId) {
            PortalUtils.showNotification('Интервью подтверждено. Уведомление отправлено кандидату.', 'success');
        };

        window.cancelInterview = function(candidateId) {
            if (confirm('Отменить интервью?')) {
                PortalUtils.showNotification('Интервью отменено', 'info');
            }
        };

        window.rescheduleInterview = function(candidateId) {
            document.getElementById('schedule-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        };

        window.viewRecording = function(interviewId) {
            PortalUtils.showNotification('Запись интервью будет загружена', 'info');
        };

        window.viewFeedback = function(interviewId) {
            PortalUtils.showNotification('Отзыв об интервью будет показан', 'info');
        };

        window.scheduleNextRound = function(candidateId) {
            document.getElementById('schedule-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        };
    </script>
</body>
</html>
